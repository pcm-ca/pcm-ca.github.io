<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true">PCM Computational Applications | Building a core/shell nanoparticle</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.65 'Arvo','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Arvo','sans-serif';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:2.25rem;line-height:2.475rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.62671rem;line-height:2.475rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.38316rem;line-height:1.65rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.65rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.85028rem;line-height:1.65rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.78405rem;line-height:1.65rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}ul{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.65rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:1rem;line-height:1.65rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}blockquote{margin-left:1.65rem;margin-right:1.65rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.65rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.65rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}li > ul{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.65rem / 2);}code{font-size:0.85rem;line-height:1.65rem;}kbd{font-size:0.85rem;line-height:1.65rem;}samp{font-size:0.85rem;line-height:1.65rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.1rem;padding-right:1.1rem;padding-top:0.825rem;padding-bottom:calc(0.825rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Arvo:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/><style>.warning{color:#9f6000;background-color:#feefb3;padding:18px}.warning:before{content:"\26A0";margin-right:9px}.rfc-page pre{font-family:inherit}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}*{box-sizing:border-box}.people{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap}.person{width:275px;margin:10px;padding:10px;border:2px solid #000;border-radius:10px;text-decoration:none;color:inherit}.person:hover{border:2px solid crimson}.person:hover .person--picture{filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur in="SourceAlpha" stdDeviation="10" /><feOffset dx="1" dy="1" result="offsetblur" /><feFlood flood-color="rgba(0,0,0,1)" /><feComposite in2="offsetblur" operator="in" /><feMerge><feMergeNode /><feMergeNode in="SourceGraphic" /></feMerge></filter></svg>#filter');-webkit-filter:drop-shadow(0 0 10px #000);filter:drop-shadow(0 0 10px black)}.person--info{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;text-align:center}.person--picture{-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;border-radius:10px;max-height:230px}.person-page{-ms-flex-direction:column;flex-direction:column}.person-page,.person-page-initial{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.person-page-initial{-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center}.person-page-picture{margin:20px;-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;border-radius:20px;width:300px;border:3px solid #000}.person-page-info{-ms-flex-direction:column;flex-direction:column;-ms-flex-align:left;align-items:left;text-align:left}.event,.person-page-info{display:-ms-flexbox;display:flex}.event{-ms-flex-direction:row;flex-direction:row}.event--info,.event--venue{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding:10px;-ms-flex-pack:center;justify-content:center}.event--venue{-ms-flex-align:end;align-items:flex-end;border-right:2px solid crimson;margin-right:20px;min-width:280px}.event--in-charge{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.event--in-charge div span{margin-right:15px}.calendar,.ulTutorials{list-style:none}.tutorial{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.tutorial--info,.tutorial--venue{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding:10px;-ms-flex-pack:center;justify-content:center}.tutorial--venue{-ms-flex-align:end;align-items:flex-end;border-right:2px solid crimson;margin-right:20px;min-width:280px}.tutorial--in-charge{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.tutorial--in-charge div span{margin-right:15px}.logos-images{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-wrap:wrap;flex-wrap:wrap}.ulTopics{list-style:none}.topic{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;border:2px solid #000;-ms-flex-align:center;align-items:center;border-radius:10px}.topic:hover{border:2px solid crimson}.topic--image--div{padding:20px}.topic--image{width:500px;padding:10px}.topic--info{-ms-flex-direction:column;flex-direction:column;padding:10px;-ms-flex-pack:center;justify-content:center;width:1500px}.topic--in-charge,.topic--info{display:-ms-flexbox;display:flex}.topic--in-charge{-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap}.topic--abstract{text-align:justify}.topic--in-charge div span{margin-left:15px}.divUpcomingPast{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;text-align:right}h1,h2,h3,h4{color:crimson}.header{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center}.logoPCM{margin-right:10px}h6{background-color:gold;margin-top:5px;font-size:1em}h6,p{color:#000}p{font-size:large;text-align:justify}nav ul{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-line-pack:center;align-content:center;-ms-flex-pack:justify;justify-content:space-between;list-style:none;font-weight:700;margin:0;margin-top:20px}nav ul li{margin:0;padding:0}nav ul li a{text-decoration:none;color:inherit}.tab{margin-left:40px}.tab,.uptext{display:inline-block}.uptext{margin-bottom:40px}.link{text-decoration:underline;color:blue}.link:hover{color:crimson}.markdown li a,.markdown p a{text-decoration:underline;color:blue}.markdown li a:hover,.markdown p a:hover{color:crimson}.markdown li p a{text-decoration:none;color:#000;font-weight:700}.markdown li p a:hover{color:crimson}.markdown div ul li blockquote p{padding:10px;border:2px solid crimson;background-color:#ffe2e9}.markdown div blockquote p{padding:10px;border:2px solid green;background-color:#d9f2d8}.markdown div ul li p img{-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center}.link-bold{text-decoration:none;color:inherit;font-weight:700}.link-bold:hover{color:crimson}.resourcesDiv{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.resourcesItems{margin-right:200px}.bottomText{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;border-top:1px solid #000;text-align:center;font-size:x-small;color:#000;height:15px;background-color:#fff;position:fixed;left:0;bottom:0;width:100%}.back-button,.forward-button{margin:0;padding:0;display:block;position:fixed;left:0;bottom:15px;height:100%;width:10%;cursor:pointer}.back-button:hover,.forward-button:hover{background:#d3d3d3;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="5" /></filter></svg>#filter');-webkit-filter:blur(5px);filter:blur(5px)}.logo-and-name{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0;margin:0}.link-logo-and-name-pcm{margin:0}.link-logo-and-name-pcm:hover{filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur in="SourceAlpha" stdDeviation="10" /><feOffset dx="1" dy="1" result="offsetblur" /><feFlood flood-color="rgba(220,20,60,1)" /><feComposite in2="offsetblur" operator="in" /><feMerge><feMergeNode /><feMergeNode in="SourceGraphic" /></feMerge></filter></svg>#filter');-webkit-filter:drop-shadow(0 0 10px crimson);filter:drop-shadow(0 0 10px crimson)}.logo-pcm,.logo-un{height:72px;margin:0}.name-pcm{margin:0;margin-left:10px;margin-right:10px}div ol li,div ul li{text-align:justify}.carousel,.carousel-inner{position:relative}.carousel-inner{overflow:hidden;width:100%}.carousel-inner>.item{display:none;position:relative;transition:left .6s ease-in-out}.carousel-inner>.item>a>img,.carousel-inner>.item>img{display:block;max-width:100%;height:auto;line-height:1}@media (-webkit-transform-3d),(transform-3d){.carousel-inner>.item{transition:transform .6s ease-in-out;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000px}.carousel-inner>.item.active.right,.carousel-inner>.item.next{transform:translate3d(100%,0,0);left:0}.carousel-inner>.item.active.left,.carousel-inner>.item.prev{transform:translate3d(-100%,0,0);left:0}.carousel-inner>.item.active,.carousel-inner>.item.next.left,.carousel-inner>.item.prev.right{transform:translateZ(0);left:0}}.carousel-inner>.active,.carousel-inner>.next,.carousel-inner>.prev{display:block}.carousel-inner>.active{left:0}.carousel-inner>.next,.carousel-inner>.prev{position:absolute;top:0;width:100%}.carousel-inner>.next{left:100%}.carousel-inner>.prev{left:-100%}.carousel-inner>.next.left,.carousel-inner>.prev.right{left:0}.carousel-inner>.active.left{left:-100%}.carousel-inner>.active.right{left:100%}.carousel-control{position:absolute;top:0;left:0;bottom:0;width:15%;opacity:.5;filter:alpha(opacity=50);font-size:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.6);background-color:transparent}.carousel-control.left{background-image:linear-gradient(90deg,rgba(0,0,0,.5) 0,rgba(0,0,0,.0001));background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="rgba(128, 0, 0, 0)",endColorstr="rgba(0, 0, 0, 0)",GradientType=1)}.carousel-control.right{left:auto;right:0;background-image:linear-gradient(90deg,rgba(0,0,0,.0001) 0,rgba(0,0,0,.5));background-repeat:repeat-x;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="rgba(0, 0, 0, 0)",endColorstr="rgba(128, 0, 0, 0)",GradientType=1)}.carousel-control:focus,.carousel-control:hover{outline:0;color:#fff;text-decoration:none;opacity:.9;filter:alpha(opacity=90)}.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next,.carousel-control .icon-prev{position:absolute;top:50%;margin-top:-10px;z-index:5;display:inline-block}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{left:50%;margin-left:-10px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{right:50%;margin-right:-10px}.carousel-control .icon-next,.carousel-control .icon-prev{width:20px;height:20px;line-height:1;font-family:serif}.carousel-control .icon-prev:before{content:"\2039"}.carousel-control .icon-next:before{content:"\203A"}.carousel-indicators{position:absolute;bottom:10px;left:50%;z-index:15;width:60%;margin-left:-30%;padding-left:0;list-style:none;text-align:center}.carousel-indicators li{display:inline-block;width:10px;height:10px;margin:1px;text-indent:-999px;border:1px solid #fff;border-radius:10px;cursor:pointer;background-color:#000\9;background-color:transparent}.carousel-indicators .active{margin:0;width:12px;height:12px;background-color:#fff}.carousel-caption{position:absolute;left:15%;right:15%;bottom:20px;z-index:10;padding-top:20px;padding-bottom:20px;color:#fff;text-align:center;text-shadow:0 1px 2px rgba(0,0,0,.6)}.carousel-caption .btn{text-shadow:none}@media screen and (min-width:768px){.carousel-control .glyphicon-chevron-left,.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next,.carousel-control .icon-prev{width:30px;height:30px;margin-top:-10px;font-size:30px}.carousel-control .glyphicon-chevron-left,.carousel-control .icon-prev{margin-left:-10px}.carousel-control .glyphicon-chevron-right,.carousel-control .icon-next{margin-right:-10px}.carousel-caption{left:20%;right:20%;padding-bottom:30px}.carousel-indicators{bottom:20px}}.container{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.container:after,.container:before{content:" ";display:table}.container:after{clear:both}@media (min-width:768px){.container{width:750px}}@media (min-width:992px){.container{width:970px}}@media (min-width:1200px){.container{width:1170px}}.container-fluid{margin-right:auto;margin-left:auto;padding-left:15px;padding-right:15px}.container-fluid:after,.container-fluid:before{content:" ";display:table}.container-fluid:after{clear:both}.row{margin-left:-15px;margin-right:-15px}.row:after,.row:before{content:" ";display:table}.row:after{clear:both}.col-lg-1,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-10,.col-lg-11,.col-lg-12,.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12,.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12,.col-xs-1,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-10,.col-xs-11,.col-xs-12{position:relative;min-height:1px;padding-left:15px;padding-right:15px}.col-xs-1,.col-xs-2,.col-xs-3,.col-xs-4,.col-xs-5,.col-xs-6,.col-xs-7,.col-xs-8,.col-xs-9,.col-xs-10,.col-xs-11,.col-xs-12{float:left}.col-xs-1{width:8.33333%}.col-xs-2{width:16.66667%}.col-xs-3{width:25%}.col-xs-4{width:33.33333%}.col-xs-5{width:41.66667%}.col-xs-6{width:50%}.col-xs-7{width:58.33333%}.col-xs-8{width:66.66667%}.col-xs-9{width:75%}.col-xs-10{width:83.33333%}.col-xs-11{width:91.66667%}.col-xs-12{width:100%}.col-xs-pull-0{right:auto}.col-xs-pull-1{right:8.33333%}.col-xs-pull-2{right:16.66667%}.col-xs-pull-3{right:25%}.col-xs-pull-4{right:33.33333%}.col-xs-pull-5{right:41.66667%}.col-xs-pull-6{right:50%}.col-xs-pull-7{right:58.33333%}.col-xs-pull-8{right:66.66667%}.col-xs-pull-9{right:75%}.col-xs-pull-10{right:83.33333%}.col-xs-pull-11{right:91.66667%}.col-xs-pull-12{right:100%}.col-xs-push-0{left:auto}.col-xs-push-1{left:8.33333%}.col-xs-push-2{left:16.66667%}.col-xs-push-3{left:25%}.col-xs-push-4{left:33.33333%}.col-xs-push-5{left:41.66667%}.col-xs-push-6{left:50%}.col-xs-push-7{left:58.33333%}.col-xs-push-8{left:66.66667%}.col-xs-push-9{left:75%}.col-xs-push-10{left:83.33333%}.col-xs-push-11{left:91.66667%}.col-xs-push-12{left:100%}.col-xs-offset-0{margin-left:0}.col-xs-offset-1{margin-left:8.33333%}.col-xs-offset-2{margin-left:16.66667%}.col-xs-offset-3{margin-left:25%}.col-xs-offset-4{margin-left:33.33333%}.col-xs-offset-5{margin-left:41.66667%}.col-xs-offset-6{margin-left:50%}.col-xs-offset-7{margin-left:58.33333%}.col-xs-offset-8{margin-left:66.66667%}.col-xs-offset-9{margin-left:75%}.col-xs-offset-10{margin-left:83.33333%}.col-xs-offset-11{margin-left:91.66667%}.col-xs-offset-12{margin-left:100%}@media (min-width:768px){.col-sm-1,.col-sm-2,.col-sm-3,.col-sm-4,.col-sm-5,.col-sm-6,.col-sm-7,.col-sm-8,.col-sm-9,.col-sm-10,.col-sm-11,.col-sm-12{float:left}.col-sm-1{width:8.33333%}.col-sm-2{width:16.66667%}.col-sm-3{width:25%}.col-sm-4{width:33.33333%}.col-sm-5{width:41.66667%}.col-sm-6{width:50%}.col-sm-7{width:58.33333%}.col-sm-8{width:66.66667%}.col-sm-9{width:75%}.col-sm-10{width:83.33333%}.col-sm-11{width:91.66667%}.col-sm-12{width:100%}.col-sm-pull-0{right:auto}.col-sm-pull-1{right:8.33333%}.col-sm-pull-2{right:16.66667%}.col-sm-pull-3{right:25%}.col-sm-pull-4{right:33.33333%}.col-sm-pull-5{right:41.66667%}.col-sm-pull-6{right:50%}.col-sm-pull-7{right:58.33333%}.col-sm-pull-8{right:66.66667%}.col-sm-pull-9{right:75%}.col-sm-pull-10{right:83.33333%}.col-sm-pull-11{right:91.66667%}.col-sm-pull-12{right:100%}.col-sm-push-0{left:auto}.col-sm-push-1{left:8.33333%}.col-sm-push-2{left:16.66667%}.col-sm-push-3{left:25%}.col-sm-push-4{left:33.33333%}.col-sm-push-5{left:41.66667%}.col-sm-push-6{left:50%}.col-sm-push-7{left:58.33333%}.col-sm-push-8{left:66.66667%}.col-sm-push-9{left:75%}.col-sm-push-10{left:83.33333%}.col-sm-push-11{left:91.66667%}.col-sm-push-12{left:100%}.col-sm-offset-0{margin-left:0}.col-sm-offset-1{margin-left:8.33333%}.col-sm-offset-2{margin-left:16.66667%}.col-sm-offset-3{margin-left:25%}.col-sm-offset-4{margin-left:33.33333%}.col-sm-offset-5{margin-left:41.66667%}.col-sm-offset-6{margin-left:50%}.col-sm-offset-7{margin-left:58.33333%}.col-sm-offset-8{margin-left:66.66667%}.col-sm-offset-9{margin-left:75%}.col-sm-offset-10{margin-left:83.33333%}.col-sm-offset-11{margin-left:91.66667%}.col-sm-offset-12{margin-left:100%}}@media (min-width:992px){.col-md-1,.col-md-2,.col-md-3,.col-md-4,.col-md-5,.col-md-6,.col-md-7,.col-md-8,.col-md-9,.col-md-10,.col-md-11,.col-md-12{float:left}.col-md-1{width:8.33333%}.col-md-2{width:16.66667%}.col-md-3{width:25%}.col-md-4{width:33.33333%}.col-md-5{width:41.66667%}.col-md-6{width:50%}.col-md-7{width:58.33333%}.col-md-8{width:66.66667%}.col-md-9{width:75%}.col-md-10{width:83.33333%}.col-md-11{width:91.66667%}.col-md-12{width:100%}.col-md-pull-0{right:auto}.col-md-pull-1{right:8.33333%}.col-md-pull-2{right:16.66667%}.col-md-pull-3{right:25%}.col-md-pull-4{right:33.33333%}.col-md-pull-5{right:41.66667%}.col-md-pull-6{right:50%}.col-md-pull-7{right:58.33333%}.col-md-pull-8{right:66.66667%}.col-md-pull-9{right:75%}.col-md-pull-10{right:83.33333%}.col-md-pull-11{right:91.66667%}.col-md-pull-12{right:100%}.col-md-push-0{left:auto}.col-md-push-1{left:8.33333%}.col-md-push-2{left:16.66667%}.col-md-push-3{left:25%}.col-md-push-4{left:33.33333%}.col-md-push-5{left:41.66667%}.col-md-push-6{left:50%}.col-md-push-7{left:58.33333%}.col-md-push-8{left:66.66667%}.col-md-push-9{left:75%}.col-md-push-10{left:83.33333%}.col-md-push-11{left:91.66667%}.col-md-push-12{left:100%}.col-md-offset-0{margin-left:0}.col-md-offset-1{margin-left:8.33333%}.col-md-offset-2{margin-left:16.66667%}.col-md-offset-3{margin-left:25%}.col-md-offset-4{margin-left:33.33333%}.col-md-offset-5{margin-left:41.66667%}.col-md-offset-6{margin-left:50%}.col-md-offset-7{margin-left:58.33333%}.col-md-offset-8{margin-left:66.66667%}.col-md-offset-9{margin-left:75%}.col-md-offset-10{margin-left:83.33333%}.col-md-offset-11{margin-left:91.66667%}.col-md-offset-12{margin-left:100%}}@media (min-width:1200px){.col-lg-1,.col-lg-2,.col-lg-3,.col-lg-4,.col-lg-5,.col-lg-6,.col-lg-7,.col-lg-8,.col-lg-9,.col-lg-10,.col-lg-11,.col-lg-12{float:left}.col-lg-1{width:8.33333%}.col-lg-2{width:16.66667%}.col-lg-3{width:25%}.col-lg-4{width:33.33333%}.col-lg-5{width:41.66667%}.col-lg-6{width:50%}.col-lg-7{width:58.33333%}.col-lg-8{width:66.66667%}.col-lg-9{width:75%}.col-lg-10{width:83.33333%}.col-lg-11{width:91.66667%}.col-lg-12{width:100%}.col-lg-pull-0{right:auto}.col-lg-pull-1{right:8.33333%}.col-lg-pull-2{right:16.66667%}.col-lg-pull-3{right:25%}.col-lg-pull-4{right:33.33333%}.col-lg-pull-5{right:41.66667%}.col-lg-pull-6{right:50%}.col-lg-pull-7{right:58.33333%}.col-lg-pull-8{right:66.66667%}.col-lg-pull-9{right:75%}.col-lg-pull-10{right:83.33333%}.col-lg-pull-11{right:91.66667%}.col-lg-pull-12{right:100%}.col-lg-push-0{left:auto}.col-lg-push-1{left:8.33333%}.col-lg-push-2{left:16.66667%}.col-lg-push-3{left:25%}.col-lg-push-4{left:33.33333%}.col-lg-push-5{left:41.66667%}.col-lg-push-6{left:50%}.col-lg-push-7{left:58.33333%}.col-lg-push-8{left:66.66667%}.col-lg-push-9{left:75%}.col-lg-push-10{left:83.33333%}.col-lg-push-11{left:91.66667%}.col-lg-push-12{left:100%}.col-lg-offset-0{margin-left:0}.col-lg-offset-1{margin-left:8.33333%}.col-lg-offset-2{margin-left:16.66667%}.col-lg-offset-3{margin-left:25%}.col-lg-offset-4{margin-left:33.33333%}.col-lg-offset-5{margin-left:41.66667%}.col-lg-offset-6{margin-left:50%}.col-lg-offset-7{margin-left:58.33333%}.col-lg-offset-8{margin-left:66.66667%}.col-lg-offset-9{margin-left:75%}.col-lg-offset-10{margin-left:83.33333%}.col-lg-offset-11{margin-left:91.66667%}.col-lg-offset-12{margin-left:100%}}.thumbnail{display:block;padding:4px;margin-bottom:20px;line-height:1.42857;background-color:#fff;border:1px solid #ddd;border-radius:4px;transition:border .2s ease-in-out}.thumbnail>img,.thumbnail a>img{display:block;max-width:100%;height:auto;margin-left:auto;margin-right:auto}.thumbnail .caption{padding:9px;color:#333}a.thumbnail.active,a.thumbnail:focus,a.thumbnail:hover{border-color:#337ab7}.btn{display:inline-block;margin-bottom:0;font-weight:400;text-align:center;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;padding:6px 12px;font-size:14px;line-height:1.42857;border-radius:4px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn.active.focus,.btn.active:focus,.btn.focus,.btn:active.focus,.btn:active:focus,.btn:focus{outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn.focus,.btn:focus,.btn:hover{color:#333;text-decoration:none}.btn.active,.btn:active{outline:0;background-image:none;box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;opacity:.65;filter:alpha(opacity=65);box-shadow:none}a.btn.disabled,fieldset[disabled] a.btn{pointer-events:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default.focus,.btn-default:focus{color:#333;background-color:#e6e6e6;border-color:#8c8c8c}.btn-default.active,.btn-default:active,.btn-default:hover,.open>.btn-default.dropdown-toggle{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default.active.focus,.btn-default.active:focus,.btn-default.active:hover,.btn-default:active.focus,.btn-default:active:focus,.btn-default:active:hover,.open>.btn-default.dropdown-toggle.focus,.open>.btn-default.dropdown-toggle:focus,.open>.btn-default.dropdown-toggle:hover{color:#333;background-color:#d4d4d4;border-color:#8c8c8c}.btn-default.active,.btn-default:active,.open>.btn-default.dropdown-toggle{background-image:none}.btn-default.disabled.focus,.btn-default.disabled:focus,.btn-default.disabled:hover,.btn-default[disabled].focus,.btn-default[disabled]:focus,.btn-default[disabled]:hover,fieldset[disabled] .btn-default.focus,fieldset[disabled] .btn-default:focus,fieldset[disabled] .btn-default:hover{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#337ab7;border-color:#2e6da4}.btn-primary.focus,.btn-primary:focus{color:#fff;background-color:#286090;border-color:#122b40}.btn-primary.active,.btn-primary:active,.btn-primary:hover,.open>.btn-primary.dropdown-toggle{color:#fff;background-color:#286090;border-color:#204d74}.btn-primary.active.focus,.btn-primary.active:focus,.btn-primary.active:hover,.btn-primary:active.focus,.btn-primary:active:focus,.btn-primary:active:hover,.open>.btn-primary.dropdown-toggle.focus,.open>.btn-primary.dropdown-toggle:focus,.open>.btn-primary.dropdown-toggle:hover{color:#fff;background-color:#204d74;border-color:#122b40}.btn-primary.active,.btn-primary:active,.open>.btn-primary.dropdown-toggle{background-image:none}.btn-primary.disabled.focus,.btn-primary.disabled:focus,.btn-primary.disabled:hover,.btn-primary[disabled].focus,.btn-primary[disabled]:focus,.btn-primary[disabled]:hover,fieldset[disabled] .btn-primary.focus,fieldset[disabled] .btn-primary:focus,fieldset[disabled] .btn-primary:hover{background-color:#337ab7;border-color:#2e6da4}.btn-primary .badge{color:#337ab7;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success.focus,.btn-success:focus{color:#fff;background-color:#449d44;border-color:#255625}.btn-success.active,.btn-success:active,.btn-success:hover,.open>.btn-success.dropdown-toggle{color:#fff;background-color:#449d44;border-color:#398439}.btn-success.active.focus,.btn-success.active:focus,.btn-success.active:hover,.btn-success:active.focus,.btn-success:active:focus,.btn-success:active:hover,.open>.btn-success.dropdown-toggle.focus,.open>.btn-success.dropdown-toggle:focus,.open>.btn-success.dropdown-toggle:hover{color:#fff;background-color:#398439;border-color:#255625}.btn-success.active,.btn-success:active,.open>.btn-success.dropdown-toggle{background-image:none}.btn-success.disabled.focus,.btn-success.disabled:focus,.btn-success.disabled:hover,.btn-success[disabled].focus,.btn-success[disabled]:focus,.btn-success[disabled]:hover,fieldset[disabled] .btn-success.focus,fieldset[disabled] .btn-success:focus,fieldset[disabled] .btn-success:hover{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info.focus,.btn-info:focus{color:#fff;background-color:#31b0d5;border-color:#1b6d85}.btn-info.active,.btn-info:active,.btn-info:hover,.open>.btn-info.dropdown-toggle{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info.active.focus,.btn-info.active:focus,.btn-info.active:hover,.btn-info:active.focus,.btn-info:active:focus,.btn-info:active:hover,.open>.btn-info.dropdown-toggle.focus,.open>.btn-info.dropdown-toggle:focus,.open>.btn-info.dropdown-toggle:hover{color:#fff;background-color:#269abc;border-color:#1b6d85}.btn-info.active,.btn-info:active,.open>.btn-info.dropdown-toggle{background-image:none}.btn-info.disabled.focus,.btn-info.disabled:focus,.btn-info.disabled:hover,.btn-info[disabled].focus,.btn-info[disabled]:focus,.btn-info[disabled]:hover,fieldset[disabled] .btn-info.focus,fieldset[disabled] .btn-info:focus,fieldset[disabled] .btn-info:hover{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning.focus,.btn-warning:focus{color:#fff;background-color:#ec971f;border-color:#985f0d}.btn-warning.active,.btn-warning:active,.btn-warning:hover,.open>.btn-warning.dropdown-toggle{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning.active.focus,.btn-warning.active:focus,.btn-warning.active:hover,.btn-warning:active.focus,.btn-warning:active:focus,.btn-warning:active:hover,.open>.btn-warning.dropdown-toggle.focus,.open>.btn-warning.dropdown-toggle:focus,.open>.btn-warning.dropdown-toggle:hover{color:#fff;background-color:#d58512;border-color:#985f0d}.btn-warning.active,.btn-warning:active,.open>.btn-warning.dropdown-toggle{background-image:none}.btn-warning.disabled.focus,.btn-warning.disabled:focus,.btn-warning.disabled:hover,.btn-warning[disabled].focus,.btn-warning[disabled]:focus,.btn-warning[disabled]:hover,fieldset[disabled] .btn-warning.focus,fieldset[disabled] .btn-warning:focus,fieldset[disabled] .btn-warning:hover{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger.focus,.btn-danger:focus{color:#fff;background-color:#c9302c;border-color:#761c19}.btn-danger.active,.btn-danger:active,.btn-danger:hover,.open>.btn-danger.dropdown-toggle{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger.active.focus,.btn-danger.active:focus,.btn-danger.active:hover,.btn-danger:active.focus,.btn-danger:active:focus,.btn-danger:active:hover,.open>.btn-danger.dropdown-toggle.focus,.open>.btn-danger.dropdown-toggle:focus,.open>.btn-danger.dropdown-toggle:hover{color:#fff;background-color:#ac2925;border-color:#761c19}.btn-danger.active,.btn-danger:active,.open>.btn-danger.dropdown-toggle{background-image:none}.btn-danger.disabled.focus,.btn-danger.disabled:focus,.btn-danger.disabled:hover,.btn-danger[disabled].focus,.btn-danger[disabled]:focus,.btn-danger[disabled]:hover,fieldset[disabled] .btn-danger.focus,fieldset[disabled] .btn-danger:focus,fieldset[disabled] .btn-danger:hover{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#337ab7;font-weight:400;border-radius:0}.btn-link,.btn-link.active,.btn-link:active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;box-shadow:none}.btn-link,.btn-link:active,.btn-link:focus,.btn-link:hover{border-color:transparent}.btn-link:focus,.btn-link:hover{color:#23527c;text-decoration:underline;background-color:transparent}.btn-link[disabled]:focus,.btn-link[disabled]:hover,fieldset[disabled] .btn-link:focus,fieldset[disabled] .btn-link:hover{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:18px;line-height:1.33333;border-radius:6px}.btn-sm{padding:5px 10px}.btn-sm,.btn-xs{font-size:12px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type=button].btn-block,input[type=reset].btn-block,input[type=submit].btn-block{width:100%}</style></head><body><div id="react-mount"><div data-reactroot="" data-reactid="1" data-react-checksum="-2038230034"><p style="background:#B9BDEF;border-bottom:2px solid black;" data-reactid="2"><div style="max-width:80%;margin-left:auto;margin-right:auto;padding-top:0;padding:0.825rem 1.2375rem;padding-bottom:10px;display:flex;flex-direction:column;text-align:center;" data-reactid="3"><a class="link-logo-and-name-pcm" title="Home" style="color:black;text-decoration:none;font-size:40px;font-weight:bold;margin-bottom:0rem;" href="/" data-reactid="4"><div class="logo-and-name" style="max-width:960px;margin-left:auto;margin-right:auto;" data-reactid="5"><img class="logo-pcm" src="/android-icon-72x72.png" alt="" data-reactid="6"/><div class="name-pcm" data-reactid="7">PCM Computational Applications</div><img class="logo-un" src="/images/logo-un.png" alt="" data-reactid="8"/><span style="display:block;clear:both;" data-reactid="9"> </span></div></a><nav data-reactid="10"><ul data-reactid="11"><li data-reactid="12"><a class="link-bold" href="/people/" data-reactid="13">People</a></li><li data-reactid="14"><a class="link-bold" href="/research/" data-reactid="15">Research</a></li><li data-reactid="16"><a class="link-bold" href="/publications/" data-reactid="17">Publications</a></li><li data-reactid="18"><a class="link-bold" href="/vegas/" data-reactid="19">𝕍egas</a></li><li data-reactid="20"><a class="link-bold" href="/resources/" data-reactid="21">Resources</a></li><li data-reactid="22"><a class="link-bold" href="/contact/" data-reactid="23">Contact us</a></li></ul></nav><span style="display:block;clear:both;" data-reactid="24"> </span></div></p><div style="max-width:80%;margin-left:auto;margin-right:auto;padding:0rem 1.2375rem;padding-top:0;" data-reactid="25"><div class="markdown" data-reactid="26"><!-- react-empty: 27 --><h1 data-reactid="28">Building a core/shell nanoparticle</h1><div data-reactid="29"><p>Let’s build a core/shell nanoparticle with a simple cubic structure using a python script.</p>
<p>Import the required libraries</p>
<ul>
<li><a href="http://www.numpy.org/">numpy</a> handles numeric arrays and mathematical operations.</li>
<li><a href="https://docs.python.org/3.7/library/itertools.html#itertools.product">product</a> returns cartesian product of input iterables.</li>
<li><a href="https://matplotlib.org/">matplotlib</a> produces figures.</li>
<li><a href="https://docs.python.org/3.7/library/collections.html#collections.defaultdict">defaultdict</a> is a dictionary where each <em>value</em> has a defined type.</li>
</ul>
<pre><code class="language-python"><span class="hljs-keyword">import</span> numpy
<span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict
</code></pre>
<p>Define the values of the core (<code>Rc</code>) and nanoparticle (<code>R</code>) radius measured in magnetic unit cells (muc). Each site is a magnetic moment.</p>
<pre><code class="language-python">Rc = <span class="hljs-number">7.5</span>
R = <span class="hljs-number">10.5</span>
</code></pre>
<p>Define the core (<code>sc</code>) and shell (<code>ss</code>) spin values, the core (<code>kc</code>) and shell (<code>ks</code>) anisotropy constants, the core-core (<code>jcc</code>), core-shell (<code>jint</code>) and shell-shell (<code>jss</code>) exchange interaction constants, and the <a href="/vegas/spin-update-policies/">spin update policy</a> for the direction of the magnetic moments. Because the atomic magnetic moment is taken as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span>, it should be considered in the units of the magnetic field in a simulation. <code>jcc = 1.0</code> is taken as the unit of energy (see <a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.92.064420">Dimitriadis et al.</a>).</p>
<pre><code class="language-python">ss = sc = <span class="hljs-number">1.0</span>
jcc = <span class="hljs-number">1.0</span>
kc = <span class="hljs-number">0.1</span> * jcc
ks = <span class="hljs-number">0.5</span> * jcc
jint = <span class="hljs-number">-0.5</span> * jcc
jss = <span class="hljs-number">-0.5</span> * jcc
update_policy = <span class="hljs-string">"adaptive"</span>
</code></pre>
<p>Create a dictionary to easily retrieve the parameters defined above.</p>
<pre><code class="language-python">spin = {
    <span class="hljs-string">"core"</span>: sc,
    <span class="hljs-string">"core_interface"</span>: sc,
    <span class="hljs-string">"shell"</span>: ss,
    <span class="hljs-string">"shell_interface"</span>: ss,
       }

kan = {
    <span class="hljs-string">"core"</span>: kc,
    <span class="hljs-string">"core_interface"</span>: kc,
    <span class="hljs-string">"shell"</span>: ks,
    <span class="hljs-string">"shell_interface"</span>: ks,
      }

jex = {
    (<span class="hljs-string">"core"</span>, <span class="hljs-string">"core"</span>): jcc,
    (<span class="hljs-string">"core"</span>, <span class="hljs-string">"shell"</span>): jint,
    (<span class="hljs-string">"shell"</span>, <span class="hljs-string">"core"</span>): jint,
    (<span class="hljs-string">"shell"</span>, <span class="hljs-string">"shell"</span>): jss
      }
</code></pre>
<p>Create a list of sites and assign them as core or shell ions according to <code>Rc</code>.</p>
<pre><code class="language-python">sites = list()
core_sites = list()
shell_sites = list()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> product(range(-int(numpy.ceil(R+<span class="hljs-number">1</span>)), int(numpy.ceil(R+<span class="hljs-number">1</span>))),
                    range(-int(numpy.ceil(R+<span class="hljs-number">1</span>)), int(numpy.ceil(R+<span class="hljs-number">1</span>))),
                    range(-int(numpy.ceil(R+<span class="hljs-number">1</span>)), int(numpy.ceil(R+<span class="hljs-number">1</span>)))):
    dist = numpy.linalg.norm(site)
    <span class="hljs-keyword">if</span> dist &lt;= R:
        sites.append(site)
        <span class="hljs-keyword">if</span> dist &lt;= Rc:
            core_sites.append(site)
        <span class="hljs-keyword">else</span>:
            shell_sites.append(site)
</code></pre>
<p>Convert the previous list to numpy arrays in order to produce a midplane cross-section for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>.</p>
<pre><code class="language-python">all_positions = numpy.array(sites)
core_positions = numpy.array(core_sites)
shell_positions = numpy.array(shell_sites)
core_positions = core_positions[core_positions[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
shell_positions = shell_positions[shell_positions[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
</code></pre>
<p>Generate a graphic of the midplane cross-section using different colors for the core and the shell ions.</p>
<pre><code class="language-python">pyplot.figure(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">8</span>))
pyplot.scatter(core_positions[:, <span class="hljs-number">0</span>], core_positions[:, <span class="hljs-number">2</span>], s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"silver"</span>, edgecolor=<span class="hljs-string">"black"</span>)
pyplot.scatter(shell_positions[:, <span class="hljs-number">0</span>], shell_positions[:, <span class="hljs-number">2</span>], s=<span class="hljs-number">150</span>, color=<span class="hljs-string">"gray"</span>, edgecolor=<span class="hljs-string">"black"</span>)
pyplot.grid()
pyplot.xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.ylabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.xlim(-R<span class="hljs-number">-1</span>, R+<span class="hljs-number">1</span>)
pyplot.ylim(-R<span class="hljs-number">-1</span>, R+<span class="hljs-number">1</span>)
pyplot.gca().set_aspect(<span class="hljs-string">"equal"</span>)
pyplot.show()
</code></pre>
<p><img src="output_16_0.png" alt="png"></p>
<p>Identify the neighbors of each magnetic moment and store them in a dictionary.</p>
<pre><code class="language-python">nhbs = defaultdict(list)
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    x, y, z = site
    <span class="hljs-keyword">for</span> dx, dy, dz <span class="hljs-keyword">in</span> [(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>),
                       (<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>),
                       (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>), (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">-1</span>)]:
        nhb = ((x + dx), (y + dy), (z + dz))
        <span class="hljs-keyword">if</span> nhb <span class="hljs-keyword">in</span> sites:
            nhbs[site].append(nhb)
</code></pre>
<p>Make some verifications: that each site has a maximum of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>6</mn></mrow><annotation encoding="application/x-tex">6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">6</span></span></span></span> neighbors, that the neighbors of each site are <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span> muc away, and that each site is in the neighbors list of each of its neighbors.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    <span class="hljs-keyword">assert</span> len(nhbs[site]) &lt;= <span class="hljs-number">6</span>
    <span class="hljs-keyword">for</span> nhb <span class="hljs-keyword">in</span> nhbs[site]:
        <span class="hljs-keyword">assert</span> numpy.linalg.norm(numpy.array(site) - numpy.array(nhb)) == <span class="hljs-number">1.0</span>
        <span class="hljs-keyword">assert</span> site <span class="hljs-keyword">in</span> nhbs[nhb]
</code></pre>
<p>Create a dictionary to identify the type of each site, which can be <code>core</code>, <code>shell</code>, <code>core_interface</code> and <code>shell_interface</code>, which corresponds to sites located in the core, the shell, the core interface and the shell interface, respectively.</p>
<pre><code class="language-python">types = dict()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    prefix = <span class="hljs-string">"core"</span> <span class="hljs-keyword">if</span> site <span class="hljs-keyword">in</span> core_sites <span class="hljs-keyword">else</span> <span class="hljs-string">"shell"</span>
    <span class="hljs-keyword">for</span> nhb <span class="hljs-keyword">in</span> nhbs[site]:
        nhb_prefix = <span class="hljs-string">"core"</span> <span class="hljs-keyword">if</span> nhb <span class="hljs-keyword">in</span> core_sites <span class="hljs-keyword">else</span> <span class="hljs-string">"shell"</span>
        <span class="hljs-keyword">if</span> prefix != nhb_prefix:
            prefix += <span class="hljs-string">"_interface"</span>
            <span class="hljs-keyword">break</span>
    types[site] = prefix
</code></pre>
<p>Create a dictionary to store all the sites of each type.</p>
<pre><code class="language-python">positions = defaultdict(list)
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    positions[types[site]].append(site)
</code></pre>
<p>Verify that there are only four ion types.</p>
<pre><code class="language-python">positions.keys()
</code></pre>
<pre><code>dict_keys(['core_interface', 'core', 'shell', 'shell_interface'])
</code></pre>
<p>Again, convert the sites list to numpy arrays in order to produce a midplane cross-section for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>.</p>
<pre><code class="language-python">core = numpy.array(positions[<span class="hljs-string">"core"</span>])
shell = numpy.array(positions[<span class="hljs-string">"shell"</span>])
core_interface = numpy.array(positions[<span class="hljs-string">"core_interface"</span>])
shell_interface = numpy.array(positions[<span class="hljs-string">"shell_interface"</span>])
core = core[core[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
shell = shell[shell[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
core_interface = core_interface[core_interface[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
shell_interface = shell_interface[shell_interface[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
</code></pre>
<p>Generate a graphic of the midplane cross-section using different colors for the core, shell, core interface and shell interface ions.</p>
<pre><code class="language-python">pyplot.figure(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">8</span>))
pyplot.scatter(core[:, <span class="hljs-number">0</span>], core[:, <span class="hljs-number">2</span>], s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"silver"</span>, edgecolor=<span class="hljs-string">"black"</span>)
pyplot.scatter(shell[:, <span class="hljs-number">0</span>], shell[:, <span class="hljs-number">2</span>], s=<span class="hljs-number">150</span>, color=<span class="hljs-string">"gray"</span>, edgecolor=<span class="hljs-string">"black"</span>)
pyplot.scatter(core_interface[:, <span class="hljs-number">0</span>], core_interface[:, <span class="hljs-number">2</span>], s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"gold"</span>, edgecolor=<span class="hljs-string">"black"</span>)
pyplot.scatter(shell_interface[:, <span class="hljs-number">0</span>], shell_interface[:, <span class="hljs-number">2</span>], s=<span class="hljs-number">150</span>, color=<span class="hljs-string">"red"</span>, edgecolor=<span class="hljs-string">"black"</span>)
pyplot.grid()
pyplot.xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.ylabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.xlim(-R<span class="hljs-number">-1</span>, R+<span class="hljs-number">1</span>)
pyplot.ylim(-R<span class="hljs-number">-1</span>, R+<span class="hljs-number">1</span>)
pyplot.gca().set_aspect(<span class="hljs-string">"equal"</span>)
pyplot.show()
</code></pre>
<p><img src="output_30_0.png" alt="png"></p>
<p>Define the anisotropy and external magnetic field axes for each site, which in this case is the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span> axis for all the ions.</p>
<pre><code class="language-python">anisotropy_axis = dict()
field_axis = dict()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    anisotropy_axis[site] = (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)
    field_axis[site] = (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)
</code></pre>
<p>Count the number of interactions equal to the sum of the neighbors of each site, and the number of sites as the length of the list of the sites.</p>
<pre><code class="language-python">num_interactions = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    num_interactions += len(nhbs[site])
num_sites = len(sites)
</code></pre>
<p>Create the files to store the structural properties (<code>sample.dat</code>) and the anisotropy (<code>anisotropy.dat</code>) of the sample.</p>
<pre><code class="language-python">sample_file = open(<span class="hljs-string">"sample.dat"</span>, mode=<span class="hljs-string">"w"</span>)
anisotropy_file = open(<span class="hljs-string">"anisotropy.dat"</span>, mode=<span class="hljs-string">"w"</span>)
</code></pre>
<p>Write in the first line of <em>sample_file</em> the number of sites, interactions and types:</p>
<pre><code class="language-python">sample_file.write(<span class="hljs-string">"{} {} {}\n"</span>.format(num_sites, num_interactions, len(set(types.values()))))
print(num_sites, num_interactions, len(set(types.values())))
</code></pre>
<pre><code>4945 27576 4
</code></pre>
<p>Write the ion types on a different line each one.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> sorted(set(types.values())):
    sample_file.write(<span class="hljs-string">"{}\n"</span>.format(t))
    print(t)
</code></pre>
<pre><code>core
core_interface
shell
shell_interface
</code></pre>
<p>Write the parameters of each site according to the established <a href="/vegas/system-building/">format</a>.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    i = sites.index(site)
    t = types[site]
    sample_file.write(<span class="hljs-string">"{} {} {} {} {} {} {} {} {} {}\n"</span>.format(i, *site, spin[t], *field_axis[site], t, update_policy))
    anisotropy_file.write(<span class="hljs-string">"{} {} {} {}\n"</span>.format(*anisotropy_axis[site], kan[t]))
</code></pre>
<p>Write the exchange interactions between every pair of neighbors.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    t = types[site]
    <span class="hljs-keyword">for</span> nhb <span class="hljs-keyword">in</span> nhbs[site]:
        nhb_t = types[nhb]
        sample_file.write(<span class="hljs-string">"{} {} {}\n"</span>.format(
            sites.index(site), sites.index(nhb),
            jex[(t.split(<span class="hljs-string">"_"</span>)[<span class="hljs-number">0</span>], nhb_t.split(<span class="hljs-string">"_"</span>)[<span class="hljs-number">0</span>])]))
</code></pre>
<p>Close the files.</p>
<pre><code class="language-python">sample_file.close()
anisotropy_file.close()
</code></pre>
<h2>Creating an initial state file</h2>
<p>When a magnetic system is simulated in 𝕍egas, the initial magnetization state of the system can be a random state or a state inputed by the user.</p>
<p>Let’s look at a case where the user needs to input the initial magnetization state: In simulations of exchange bias in core/shell nanoparticles, it is necessary to cool down the nanoparticle from a temperature between the Néel temperature of the antiferromagnetic shell (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">T_N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>) and the Curie temperature of the ferromagnetic core (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">T_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>), in presence of an external magnetic field (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">H_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>), to a very low temperature <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>s</mi><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{sim}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>. However, this cooling process can be avoided using an energy minimization procedure. The ferromagnetic core ions are first oriented along the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>+</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">+z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">+</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span> direction, indicating the desired core orientation at positive field saturation. The antiferromagnetic shell is then set with one of two polarities, AFM+ and AFM−, indicating whether alternate atoms in the lattice are up-down-up-down or down-up-down-up. For each of the polarities the total system energy is calculated, and the polarity with the lowest energy is then selected. This process ensured a left shift of the hysteresis loop for all particles, consistent with the setting of a fully saturated exchange-bias system (see <a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.84.092404">Evans et al.</a>).</p>
<p>Let’s implement this energy minimization procedure in the current python script.</p>
<p>Define a function to calculate the energy of the system in presence of an external magnetic field <code>Hmax</code>:</p>
<pre><code class="language-python">Hmax = <span class="hljs-number">1.0</span>
</code></pre>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">energy</span><span class="hljs-params">(state, Hmax)</span>:</span>
    E_exchange = <span class="hljs-number">0.0</span>
    E_other = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> i, site <span class="hljs-keyword">in</span> enumerate(sites):
        t = types[site].split(<span class="hljs-string">"_"</span>)[<span class="hljs-number">0</span>]
        <span class="hljs-keyword">for</span> nbh <span class="hljs-keyword">in</span> nhbs[site]:
            t_nbh = types[nbh].split(<span class="hljs-string">"_"</span>)[<span class="hljs-number">0</span>]
            E_exchange -= state[i] * state[sites.index(nbh)] * jex[(t, t_nbh)]
        E_other -= (Hmax * state[i] + (kan[t] * state[i])**<span class="hljs-number">2</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * E_exchange + E_other
</code></pre>
<p>Create one of the two possible magnetization states where the orientation of the spin moments in the shell are  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>↑</mo><mo>↓</mo><mo>↑</mo><mo>↓</mo></mrow><annotation encoding="application/x-tex">\uparrow \downarrow \uparrow \downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mrel">↑</span><span class="mrel">↓</span><span class="mrel">↑</span><span class="mrel">↓</span></span></span></span> and in the core are <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>↑</mo><mo>↑</mo><mo>↑</mo><mo>↑</mo></mrow><annotation encoding="application/x-tex">\uparrow \uparrow \uparrow \uparrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mrel">↑</span><span class="mrel">↑</span><span class="mrel">↑</span><span class="mrel">↑</span></span></span></span>:</p>
<pre><code class="language-python">state1 = list()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    <span class="hljs-keyword">if</span> types[site].split(<span class="hljs-string">"_"</span>)[<span class="hljs-number">0</span>] == <span class="hljs-string">"shell"</span>:
        <span class="hljs-keyword">if</span> sum(site) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:
            state1.append(<span class="hljs-number">-1.0</span>)
        <span class="hljs-keyword">else</span>:
            state1.append(<span class="hljs-number">1.0</span>)
    <span class="hljs-keyword">else</span>:
        state1.append(<span class="hljs-number">1.0</span>)
        
state1 = numpy.array(state1)
</code></pre>
<p>And create the other possible magnetization state where the orientation of the spin moments in the shell are  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>↓</mo><mo>↑</mo><mo>↓</mo><mo>↑</mo></mrow><annotation encoding="application/x-tex">\downarrow \uparrow \downarrow \uparrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mrel">↓</span><span class="mrel">↑</span><span class="mrel">↓</span><span class="mrel">↑</span></span></span></span> and in the core are <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>↑</mo><mo>↑</mo><mo>↑</mo><mo>↑</mo></mrow><annotation encoding="application/x-tex">\uparrow \uparrow \uparrow \uparrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mrel">↑</span><span class="mrel">↑</span><span class="mrel">↑</span><span class="mrel">↑</span></span></span></span>:</p>
<pre><code class="language-python">state2 = list()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    <span class="hljs-keyword">if</span> types[site].split(<span class="hljs-string">"_"</span>)[<span class="hljs-number">0</span>] == <span class="hljs-string">"shell"</span>:
        <span class="hljs-keyword">if</span> sum(site) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:
            state2.append(<span class="hljs-number">1.0</span>)
        <span class="hljs-keyword">else</span>:
            state2.append(<span class="hljs-number">-1.0</span>)
    <span class="hljs-keyword">else</span>:
        state2.append(<span class="hljs-number">1.0</span>)

state2 = numpy.array(state2)
</code></pre>
<p>In order to visualize both magnetization states, create midplane cross-section for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>:</p>
<pre><code class="language-python">directions1 = state1[all_positions[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
layer1 = all_positions[all_positions[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
x1, y1, z1 = layer1.T

directions2 = state2[all_positions[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
layer2 = all_positions[all_positions[:, <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>]
x2, y2, z2 = layer1.T
</code></pre>
<p>Plot both midplane cross-sections. In both cases the core ions are oriented along the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>+</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">+z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">+</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span> direction, while the the shell ions are alternated in different ways, as expected.</p>
<pre><code class="language-python">fig = pyplot.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">8</span>))
ax1 = fig.add_subplot(<span class="hljs-number">121</span>)
ax2 = fig.add_subplot(<span class="hljs-number">122</span>)

ax1.add_artist(pyplot.Circle((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), Rc, color=<span class="hljs-string">'black'</span>, fill=<span class="hljs-keyword">False</span>, lw=<span class="hljs-number">2</span>))
ax1.add_artist(pyplot.Circle((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), R, color=<span class="hljs-string">'black'</span>, fill=<span class="hljs-keyword">False</span>, lw=<span class="hljs-number">2</span>))
ax1.quiver(x1, z1, <span class="hljs-number">0</span>, directions1, directions1, pivot=<span class="hljs-string">"middle"</span>,
           cmap=<span class="hljs-string">"prism"</span>, scale=<span class="hljs-number">25</span>, width=<span class="hljs-number">0.005</span>, lw=<span class="hljs-number">0.5</span>, zorder=<span class="hljs-number">10</span>)
ax1.set_title(<span class="hljs-string">"State 1"</span>)

ax2.add_artist(pyplot.Circle((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), Rc, color=<span class="hljs-string">'black'</span>, fill=<span class="hljs-keyword">False</span>, lw=<span class="hljs-number">2</span>))
ax2.add_artist(pyplot.Circle((<span class="hljs-number">0</span>, <span class="hljs-number">0</span>), R, color=<span class="hljs-string">'black'</span>, fill=<span class="hljs-keyword">False</span>, lw=<span class="hljs-number">2</span>))
ax2.quiver(x2, z2, <span class="hljs-number">0</span>, directions2, directions2, pivot=<span class="hljs-string">"middle"</span>,
           cmap=<span class="hljs-string">"prism"</span>, scale=<span class="hljs-number">25</span>, width=<span class="hljs-number">0.005</span>, lw=<span class="hljs-number">0.5</span>, zorder=<span class="hljs-number">10</span>)
ax2.set_title(<span class="hljs-string">"State 2"</span>)

<span class="hljs-keyword">for</span> ax <span class="hljs-keyword">in</span> [ax1, ax2]:
    ax.grid()
    ax.set_xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
    ax.set_ylabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
    ax.set_xlim(-R<span class="hljs-number">-1</span>, R+<span class="hljs-number">1</span>)
    ax.set_ylim(-R<span class="hljs-number">-1</span>, R+<span class="hljs-number">1</span>)
    ax.set_aspect(<span class="hljs-string">"equal"</span>)
pyplot.show()
</code></pre>
<p><img src="output_59_0.png" alt="png"></p>
<p>Call the function <code>energy</code> to compute the energy of the two magnetization states.</p>
<pre><code class="language-python">print(<span class="hljs-string">"state1: "</span>, energy(state1, Hmax))
print(<span class="hljs-string">"state2: "</span>, energy(state2, Hmax))
</code></pre>
<pre><code>state1:  -11186.41
state2:  -11576.41
</code></pre>
<p>In this case, the magnetization state <code>state2</code> minimizes the energy. However, this could change for nanoparticles of different size. Then, it is always recommended to compute and compare both energies.</p>
<pre><code class="language-python">state = state1 <span class="hljs-keyword">if</span> energy(state1, Hmax) &lt;= energy(state2, Hmax) <span class="hljs-keyword">else</span> state2
</code></pre>
<p>Finally, create the file to store the initial state of the nanoparticle (<code>initialstate.dat</code>):</p>
<pre><code class="language-python">initialstate_file = open(<span class="hljs-string">"initialstate.dat"</span>, mode=<span class="hljs-string">"w"</span>)
</code></pre>
<pre><code class="language-python"><span class="hljs-keyword">for</span> i, site <span class="hljs-keyword">in</span> enumerate(sites):
    initialstate_file.write(<span class="hljs-string">"{} {} {}\n"</span>.format(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, state[i]))
</code></pre>
<pre><code class="language-python">initialstate_file.close()
</code></pre>
<p>The result of this script is the creation of three files: <code>sample.dat</code>, <code>anisotropy.dat</code> and <code>initialstate.dat</code>, which store the structural properties, the anisotropy and the initial magnetic state of the core/shell nanoparticle.</p>
<hr>
<ul>
<li>
<p><a href="/vegas/">Home</a></p>
</li>
<li>
<p><a href="/vegas/model-and-method/">Model and method</a></p>
</li>
<li>
<p><a href="/vegas/installation/">Installation</a></p>
</li>
<li>
<p><a href="/vegas/system-building/">System building</a></p>
</li>
<li>
<p><a href="/vegas/simulation-and-data-analysis/">Simulation and data analysis</a></p>
</li>
<li>
<p><a href="/vegas/tutorials/">Tutorials</a></p>
</li>
</ul>
</div></div><span style="display:block;clear:both;" data-reactid="30"> </span></div><div class="bottomText" data-reactid="31"><div data-reactid="32"><!-- react-text: 33 -->PCM Computational Applications, designed by:<!-- /react-text --><a class="link" href="/people/jdalzatec/" data-reactid="34">jdalzatec</a><!-- react-text: 35 -->,<!-- /react-text --><a class="link" href="/people/dasabogals/" data-reactid="36">dasabogals</a><!-- react-text: 37 -->,<!-- /react-text --><a class="link" href="/people/odarbelaeze/" data-reactid="38">odarbelaeze</a></div></div></div></div><script src="/bundle.js?t=1529677085112"></script></body></html>