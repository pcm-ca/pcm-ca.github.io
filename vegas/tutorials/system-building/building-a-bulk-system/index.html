<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true">PCM Computational Applications | Building a bulk system</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.65 'Arvo','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Arvo','sans-serif';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:2.25rem;line-height:2.475rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.62671rem;line-height:2.475rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.38316rem;line-height:1.65rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.65rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.85028rem;line-height:1.65rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.78405rem;line-height:1.65rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}ul{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.65rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:1rem;line-height:1.65rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}blockquote{margin-left:1.65rem;margin-right:1.65rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.65rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.65rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}li > ul{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.65rem / 2);}code{font-size:0.85rem;line-height:1.65rem;}kbd{font-size:0.85rem;line-height:1.65rem;}samp{font-size:0.85rem;line-height:1.65rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.1rem;padding-right:1.1rem;padding-top:0.825rem;padding-bottom:calc(0.825rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:"¬†";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Arvo:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/><style>.warning{color:#9f6000;background-color:#feefb3;padding:18px}.warning:before{content:"\26A0";margin-right:9px}.rfc-page pre{font-family:inherit}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><div id="react-mount"><div data-reactroot="" data-reactid="1" data-react-checksum="-870294873"><p style="background:#B9BDEF;border-bottom:2px solid black;" data-reactid="2"><div style="max-width:80%;margin-left:auto;margin-right:auto;padding-top:0;padding:0.825rem 1.2375rem;padding-bottom:10px;display:flex;flex-direction:column;text-align:center;" data-reactid="3"><a class="link-logo-and-name-pcm" title="Home" style="color:black;text-decoration:none;font-size:40px;font-weight:bold;margin-bottom:0rem;" href="/" data-reactid="4"><div class="logo-and-name" style="max-width:960px;margin-left:auto;margin-right:auto;" data-reactid="5"><img class="logo-pcm" src="/android-icon-72x72.png" alt="" data-reactid="6"/><div class="name-pcm" data-reactid="7">PCM Computational Applications</div><img class="logo-un" src="/images/logo-un.png" alt="" data-reactid="8"/><span style="display:block;clear:both;" data-reactid="9"> </span></div></a><nav data-reactid="10"><ul data-reactid="11"><li data-reactid="12"><a class="link-bold" href="/people/" data-reactid="13">People</a></li><li data-reactid="14"><a class="link-bold" href="/research/" data-reactid="15">Research</a></li><li data-reactid="16"><a class="link-bold" href="/publications/" data-reactid="17">Publications</a></li><li data-reactid="18"><a class="link-bold" href="/vegas/" data-reactid="19">ùïçegas</a></li><li data-reactid="20"><a class="link-bold" href="/resources/" data-reactid="21">Resources</a></li><li data-reactid="22"><a class="link-bold" href="/contact/" data-reactid="23">Contact us</a></li></ul></nav><span style="display:block;clear:both;" data-reactid="24"> </span></div></p><div style="max-width:80%;margin-left:auto;margin-right:auto;padding:0rem 1.2375rem;padding-top:0;" data-reactid="25"><div class="markdown" data-reactid="26"><!-- react-empty: 27 --><h1 data-reactid="28">Building a bulk system</h1><div data-reactid="29"><p>Let‚Äôs build a Fe bulk with BCC structure using a python script.</p>
<p>Import the required libraries</p>
<ul>
<li><a href="http://www.numpy.org/">numpy</a> handles numeric arrays and mathematical operations.</li>
<li><a href="https://docs.python.org/3.7/library/itertools.html#itertools.product">product</a> returns cartesian product of input iterables.</li>
<li><a href="https://matplotlib.org/">matplotlib</a> produces figures.</li>
<li><a href="https://docs.python.org/3.7/library/collections.html#collections.defaultdict">defaultdict</a> is a dictionary where each <em>value</em> has a defined type.</li>
<li><a href="https://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html">Axes3D</a> produces 3D graphics using matplotlib.</li>
</ul>
<pre><code class="language-python"><span class="hljs-keyword">import</span> numpy
<span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict
<span class="hljs-keyword">from</span> mpl_toolkits.mplot3d <span class="hljs-keyword">import</span> Axes3D
</code></pre>
<p>Define the edge length of the bulk (<code>L</code>) measured in magnetic unit cells (muc).</p>
<pre><code class="language-python">L = <span class="hljs-number">5</span> <span class="hljs-comment"># muc</span>
</code></pre>
<p>Define the spin value (<code>spin</code>), its magnetic moment (<code>mu</code>), the anisotropy constant (<code>kan</code>) and the nearest neighbors exchange interaction (<code>jex</code>). These values were reported <a href="http://iopscience.iop.org/article/10.1088/0953-8984/26/10/103202/meta">elsewhere</a>. In order to use coherent units, <code>kan</code> and <code>jex</code> are given both in units of energy (meV), while <code>mu</code> is given in units of energy/magnetic field (meV/T). Then, the Boltzmann constant must be given in units of energy/temperature (meV/K) in the JSON input file. Finally, define the <a href="/vegas/spin-update-policies/">spin update policy</a> for the direction of the magnetic moments.</p>
<pre><code class="language-python">mub =  <span class="hljs-number">5.788e-2</span> <span class="hljs-comment"># meV/T</span>
</code></pre>
<pre><code class="language-python">spin = <span class="hljs-number">1.0</span>
mu = <span class="hljs-number">2.22</span> * mub
kan = <span class="hljs-number">3.53e-3</span> <span class="hljs-comment"># meV/atom</span>
jex = <span class="hljs-number">44.01</span> <span class="hljs-comment"># meV/link</span>
update_policy = <span class="hljs-string">"adaptive"</span>
</code></pre>
<p>Create a list of sites.</p>
<pre><code class="language-python">sites = list()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> product(range(<span class="hljs-number">0</span>, L), range(<span class="hljs-number">0</span>, L), range(<span class="hljs-number">0</span>, L)):
    sites.append(site)
    
    x, y, z = site
    sites.append((x + <span class="hljs-number">0.5</span>, y + <span class="hljs-number">0.5</span>, z + <span class="hljs-number">0.5</span>))
</code></pre>
<p>Convert the previous list to numpy arrays.</p>
<pre><code class="language-python">positions = numpy.array(sites)
</code></pre>
<p>Generate a 3D graphic of the Fe bulk.</p>
<pre><code class="language-python">fig = pyplot.figure(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">8</span>))
ax = fig.add_subplot(<span class="hljs-number">111</span>, projection=<span class="hljs-string">'3d'</span>)
ax.scatter(positions[:, <span class="hljs-number">0</span>], positions[:, <span class="hljs-number">1</span>], positions[:, <span class="hljs-number">2</span>],
           s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"silver"</span>, edgecolor=<span class="hljs-string">"black"</span>)
ax.grid()
ax.set_xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
ax.set_ylabel(<span class="hljs-string">r"$y$"</span>, fontsize=<span class="hljs-number">20</span>)
ax.set_zlabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
ax.set_aspect(<span class="hljs-string">"equal"</span>)
pyplot.show()
</code></pre>
<p><img src="output_15_0.png" alt="png"></p>
<p>Generate graphics of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">xz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">yz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span> plane cross-sections to better visualize the BBC structure.</p>
<pre><code class="language-python">fig = pyplot.figure(figsize=(<span class="hljs-number">8</span>, <span class="hljs-number">8</span>))

ax1 = fig.add_subplot(<span class="hljs-number">131</span>)
ax1.scatter(positions[:, <span class="hljs-number">0</span>], positions[:, <span class="hljs-number">1</span>],
           s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"silver"</span>, edgecolor=<span class="hljs-string">"black"</span>)
ax1.grid()
ax1.set_xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.set_ylabel(<span class="hljs-string">r"$y$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.set_aspect(<span class="hljs-string">"equal"</span>)

ax2 = fig.add_subplot(<span class="hljs-number">132</span>)
ax2.scatter(positions[:, <span class="hljs-number">0</span>], positions[:, <span class="hljs-number">2</span>],
           s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"silver"</span>, edgecolor=<span class="hljs-string">"black"</span>)
ax2.grid()
ax2.set_xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.set_ylabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.set_aspect(<span class="hljs-string">"equal"</span>)


ax3 = fig.add_subplot(<span class="hljs-number">133</span>)
ax3.scatter(positions[:, <span class="hljs-number">1</span>], positions[:, <span class="hljs-number">2</span>],
           s=<span class="hljs-number">100</span>, color=<span class="hljs-string">"silver"</span>, edgecolor=<span class="hljs-string">"black"</span>)
ax3.grid()
ax3.set_xlabel(<span class="hljs-string">r"$y$"</span>, fontsize=<span class="hljs-number">20</span>)
ax3.set_ylabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
ax3.set_aspect(<span class="hljs-string">"equal"</span>)

pyplot.tight_layout()
pyplot.show()
</code></pre>
<p><img src="output_17_0.png" alt="png"></p>
<p>Identify the neighbors of each magnetic moment and store them in a dictionary. Periodic boundary conditions are established.</p>
<pre><code class="language-python">nhbs = defaultdict(list)
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    x, y, z = site
    <span class="hljs-keyword">for</span> dx, dy, dz <span class="hljs-keyword">in</span> [(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>),
                       (<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">-0.5</span>),
                       (<span class="hljs-number">0.5</span>, <span class="hljs-number">-0.5</span>, <span class="hljs-number">0.5</span>),
                       (<span class="hljs-number">0.5</span>, <span class="hljs-number">-0.5</span>, <span class="hljs-number">-0.5</span>),
                       (<span class="hljs-number">-0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>),
                       (<span class="hljs-number">-0.5</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">-0.5</span>),
                       (<span class="hljs-number">-0.5</span>, <span class="hljs-number">-0.5</span>, <span class="hljs-number">0.5</span>),
                       (<span class="hljs-number">-0.5</span>, <span class="hljs-number">-0.5</span>, <span class="hljs-number">-0.5</span>)]:
        nhb = ((x + dx) % L, (y + dy) % L, (z + dz) % L)
        <span class="hljs-keyword">if</span> nhb <span class="hljs-keyword">in</span> sites:
            nhbs[site].append(nhb)
</code></pre>
<p>Make some verifications: that each site has <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>8</mn></mrow><annotation encoding="application/x-tex">8</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">8</span></span></span></span> neighbors, that the neighbors of each site are <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><msqrt><mrow><mn>3</mn></mrow></msqrt></mrow><mrow><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\dfrac{\sqrt{3}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5842200000000002em;"></span><span class="strut bottom" style="height:2.27022em;vertical-align:-0.686em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.06722000000000006em;"><span class="style-wrap reset-textstyle textstyle uncramped">‚àö</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="mord textstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.8272200000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span>‚Äã</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span> muc away, and that each site is in the neighbors list of each of its neighbors. If two sites are neighbors because of the periodic boundary conditions, they are not <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><msqrt><mrow><mn>3</mn></mrow></msqrt></mrow><mrow><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\dfrac{\sqrt{3}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5842200000000002em;"></span><span class="strut bottom" style="height:2.27022em;vertical-align:-0.686em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="sqrt mord"><span class="sqrt-sign" style="top:-0.06722000000000006em;"><span class="style-wrap reset-textstyle textstyle uncramped">‚àö</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="mord textstyle cramped"><span class="mord mathrm">3</span></span></span><span style="top:-0.8272200000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span>‚Äã</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span> muc away. However, one of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mn>7</mn></mrow><annotation encoding="application/x-tex">27</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">7</span></span></span></span> replicas must be this distance away.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    <span class="hljs-keyword">assert</span> len(nhbs[site]) == <span class="hljs-number">8</span>
    <span class="hljs-keyword">for</span> nhb <span class="hljs-keyword">in</span> nhbs[site]:
        <span class="hljs-keyword">assert</span> site <span class="hljs-keyword">in</span> nhbs[nhb]
        
        dists = list()
        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> [-L, <span class="hljs-number">0</span>, L]:
            <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> [-L, <span class="hljs-number">0</span>, L]:
                <span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> [-L, <span class="hljs-number">0</span>, L]:
                    dists.append(numpy.linalg.norm(numpy.array(site) + (x, y, z) - numpy.array(nhb)))
        <span class="hljs-keyword">assert</span> (<span class="hljs-number">27</span> - numpy.count_nonzero(numpy.array(dists) - (numpy.sqrt(<span class="hljs-number">3</span>)/<span class="hljs-number">2</span>)) == <span class="hljs-number">1</span>)
</code></pre>
<p>Create a dictionary to identify the type of each site, which in this case is Fe for all.</p>
<pre><code class="language-python">types = dict()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    types[site] = <span class="hljs-string">"Fe"</span>
</code></pre>
<p>Define the anisotropy axes. It is enough to just define two axes, the third one is computed to produce cubic anisotropy.  Also, define the direction of the external magnetic field for each site, which in this case is the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>+</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">+z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">+</span><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span> direction for all the ions. The external magnetic field is multiplied by the magnetic moment of Fe. Then, the magnetic field values in the JSON input file must be given in Teslas.</p>
<pre><code class="language-python">anisotropy_axis = dict()
field_axis = dict()
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    anisotropy_axis[site] = [(<span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), (<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>)]
    field_axis[site] = (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, mu)
</code></pre>
<p>Count the number of interactions equal to the sum of the neighbors of each site, and the number of sites as the length of the list of the sites.</p>
<pre><code class="language-python">num_interactions = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    num_interactions += len(nhbs[site])
num_sites = len(sites)
</code></pre>
<p>Create the files to store the structural properties (<code>sample.dat</code>) and the anisotropy (<code>anisotropy.dat</code>) of the sample.</p>
<pre><code class="language-python">sample_file = open(<span class="hljs-string">"sample.dat"</span>, mode=<span class="hljs-string">"w"</span>)
anisotropy_file = open(<span class="hljs-string">"anisotropy.dat"</span>, mode=<span class="hljs-string">"w"</span>)
</code></pre>
<p>Write in the first line of <code>sample_file</code> the number of sites, interactions and types:</p>
<pre><code class="language-python">sample_file.write(<span class="hljs-string">"{} {} {}\n"</span>.format(num_sites, num_interactions, len(set(types.values()))))
print(num_sites, num_interactions, len(set(types.values())))
</code></pre>
<pre><code>250 2000 1
</code></pre>
<p>Write the ion types on a different line each one.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> sorted(set(types.values())):
    sample_file.write(<span class="hljs-string">"{}\n"</span>.format(t))
    print(t)
</code></pre>
<pre><code>Fe
</code></pre>
<p>Write the parameters of each site according to the established <a href="/vegas/system-building/">format</a>.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    i = sites.index(site)
    t = types[site]
    sample_file.write(<span class="hljs-string">"{} {} {} {} {} {} {} {} {} {}\n"</span>.format(
        i, *site, spin, *field_axis[site], t, update_policy))
    
    anisotropy_file.write(<span class="hljs-string">"{} {} {} {} {} {} {}\n"</span>.format(
        *anisotropy_axis[site][<span class="hljs-number">0</span>],
        *anisotropy_axis[site][<span class="hljs-number">1</span>],
        kan))
</code></pre>
<p>Write the exchange interactions between every pair of neighbors.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
    t = types[site]
    <span class="hljs-keyword">for</span> nhb <span class="hljs-keyword">in</span> nhbs[site]:
        nhb_t = types[nhb]
        sample_file.write(<span class="hljs-string">"{} {} {}\n"</span>.format(
            sites.index(site), sites.index(nhb), jex))
</code></pre>
<p>Close the files.</p>
<pre><code class="language-python">sample_file.close()
anisotropy_file.close()
</code></pre>
<p>The result of this script is the creation of two files: <code>sample.dat</code> and <code>anisotropy.dat</code>, which store the structural properties and the anisotropy of the Fe bulk system.</p>
<hr>
<ul>
<li>
<p><a href="/vegas/">Home</a></p>
</li>
<li>
<p><a href="/vegas/model-and-method/">Model and method</a></p>
</li>
<li>
<p><a href="/vegas/installation/">Installation</a></p>
</li>
<li>
<p><a href="/vegas/system-building/">System building</a></p>
</li>
<li>
<p><a href="/vegas/simulation-and-data-analysis/">Simulation and data analysis</a></p>
</li>
<li>
<p><a href="/vegas/tutorials/">Tutorials</a></p>
</li>
</ul>
</div></div><span style="display:block;clear:both;" data-reactid="30"> </span></div><div class="bottomText" data-reactid="31"><div data-reactid="32"><!-- react-text: 33 -->PCM Computational Applications, designed by:<!-- /react-text --><a class="link" href="/people/jdalzatec/" data-reactid="34">jdalzatec</a><!-- react-text: 35 -->,<!-- /react-text --><a class="link" href="/people/dasabogals/" data-reactid="36">dasabogals</a><!-- react-text: 37 -->,<!-- /react-text --><a class="link" href="/people/odarbelaeze/" data-reactid="38">odarbelaeze</a></div></div></div></div><script src="/bundle.js?t=1529681161071"></script></body></html>