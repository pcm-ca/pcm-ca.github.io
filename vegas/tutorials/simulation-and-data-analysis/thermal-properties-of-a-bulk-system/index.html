<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true">PCM Computational Applications | Thermal properties of a bulk system</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.65 'Arvo','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Arvo','sans-serif';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:2.25rem;line-height:2.475rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.62671rem;line-height:2.475rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.38316rem;line-height:1.65rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.65rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.85028rem;line-height:1.65rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.78405rem;line-height:1.65rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}ul{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.65rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:1rem;line-height:1.65rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}blockquote{margin-left:1.65rem;margin-right:1.65rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.65rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.65rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}li > ul{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.65rem / 2);}code{font-size:0.85rem;line-height:1.65rem;}kbd{font-size:0.85rem;line-height:1.65rem;}samp{font-size:0.85rem;line-height:1.65rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.1rem;padding-right:1.1rem;padding-top:0.825rem;padding-bottom:calc(0.825rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Arvo:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/><style>.warning{color:#9f6000;background-color:#feefb3;padding:18px}.warning:before{content:"\26A0";margin-right:9px}.rfc-page pre{font-family:inherit}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><div id="react-mount"><div data-reactroot="" data-reactid="1" data-react-checksum="-1811575538"><p style="background:#B9BDEF;border-bottom:2px solid black;" data-reactid="2"><div style="max-width:80%;margin-left:auto;margin-right:auto;padding-top:0;padding:0.825rem 1.2375rem;padding-bottom:10px;display:flex;flex-direction:column;text-align:center;" data-reactid="3"><a class="link-logo-and-name-pcm" title="Home" style="color:black;text-decoration:none;font-size:40px;font-weight:bold;margin-bottom:0rem;" href="/" data-reactid="4"><div class="logo-and-name" style="max-width:960px;margin-left:auto;margin-right:auto;" data-reactid="5"><img class="logo-pcm" src="/android-icon-72x72.png" alt="" data-reactid="6"/><div class="name-pcm" data-reactid="7">PCM Computational Applications</div><img class="logo-un" src="/images/logo-un.png" alt="" data-reactid="8"/><span style="display:block;clear:both;" data-reactid="9"> </span></div></a><nav data-reactid="10"><ul data-reactid="11"><li data-reactid="12"><a class="link-bold" href="/people/" data-reactid="13">People</a></li><li data-reactid="14"><a class="link-bold" href="/research/" data-reactid="15">Research</a></li><li data-reactid="16"><a class="link-bold" href="/publications/" data-reactid="17">Publications</a></li><li data-reactid="18"><a class="link-bold" href="/vegas/" data-reactid="19">𝕍egas</a></li><li data-reactid="20"><a class="link-bold" href="/resources/" data-reactid="21">Resources</a></li><li data-reactid="22"><a class="link-bold" href="/contact/" data-reactid="23">Contact us</a></li></ul></nav><span style="display:block;clear:both;" data-reactid="24"> </span></div></p><div style="max-width:80%;margin-left:auto;margin-right:auto;padding:0rem 1.2375rem;padding-top:0;" data-reactid="25"><div class="markdown" data-reactid="26"><!-- react-empty: 27 --><h1 data-reactid="28">Thermal properties of a bulk system</h1><div data-reactid="29"><p>In this tutorial, we explain how to simulate thermal behavior of a bulk system.</p>
<p>The system in consideration is a Fe bulk with BCC structure. Nearest neighbors exchange interactions and cubic anisotropy were considered. To describe the ferromagnetic behavior of Fe, the following parameters were used:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>=</mo><mn>4</mn><mn>4</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn><mtext> </mtext><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">V</mi></mtext><mi mathvariant="normal">/</mi><mtext><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi><mi mathvariant="normal">k</mi></mtext></mrow><annotation encoding="application/x-tex">J=44.01\ \text{meV}/\text{link}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mrel">=</span><span class="mord mathrm">4</span><span class="mord mathrm">4</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span><span class="mord mspace"> </span><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">m</span><span class="mord mathrm">e</span><span class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span class="mord mathrm">/</span><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">l</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span><span class="mord mathrm">k</span></span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>3</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>3</mn><mi>e</mi><mo>−</mo><mn>3</mn><mtext> </mtext><mtext><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">V</mi></mtext><mi mathvariant="normal">/</mi><mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mtext></mrow><annotation encoding="application/x-tex">k=3.53e-3\ \text{meV}/\text{atom}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">3</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">3</span><span class="mord mathit">e</span><span class="mbin">−</span><span class="mord mathrm">3</span><span class="mord mspace"> </span><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">m</span><span class="mord mathrm">e</span><span class="mord mathrm" style="margin-right:0.01389em;">V</span></span><span class="mord mathrm">/</span><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">t</span><span class="mord mathrm">o</span><span class="mord mathrm">m</span></span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mrow><mi mathvariant="bold">S</mi></mrow><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">|\mathbf{S}|=1.0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">S</span></span><span class="mord mathrm">∣</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>μ</mi><mi>s</mi></msub><mo>=</mo><mn>2</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>2</mn><msub><mi>μ</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">\mu_s=2.22\mu_B
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mord mathrm">.</span><span class="mord mathrm">2</span><span class="mord mathrm">2</span><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span>
<center>Spin update policy: Adaptive move</center>
<br/>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mrow><mi mathvariant="bold">S</mi></mrow><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\mathbf{S}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord textstyle uncramped"><span class="mord mathbf">S</span></span><span class="mord mathrm">∣</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>μ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\mu_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">μ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> are the nearest neighbor exchange interaction constant, anisotropy constant, spin moment and atomic magnetic moment, respectively.</p>
<p>The simulation is carried out cooling down the Fe bulk from a high to a low temperature. Plots of the magnetization, energy, susceptibility and specific heat are extracted from the simulation results. Furthermore, graphics of magnetization states at different temperatures are produced.</p>
<h2>Simulation</h2>
<p>As explained in the <a href="vegas/simulation-and-data-analysis/">simulation section</a>, four input files with established formats are used perform a simulation:</p>
<ul>
<li>Configuration file (<a class="Link" href="config.json" target="_blank">config.json</a>): These simulation parameters are set to cool down the bulk system from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>5</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">1500</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span> K without presence of external magnetic field. Units are coherent with the units used in the <a href="/vegas/tutorials/system-building/building-a-bulk-system/">system building</a>. Then, <code>kb</code> is given in meV/K, <code>field</code> in T and <code>temperature</code> in K. The content of the configuration file is shown below:</li>
</ul>
<pre><code class="language-json">{
    <span class="hljs-attr">"sample"</span>: <span class="hljs-string">"sample.dat"</span>,
    <span class="hljs-attr">"anisotropy"</span>: <span class="hljs-string">"anisotropy.dat"</span>,
    <span class="hljs-attr">"out"</span>: <span class="hljs-string">"results.h5"</span>,
    <span class="hljs-attr">"kb"</span>: <span class="hljs-number">0.08618</span>,
    <span class="hljs-attr">"mcs"</span>: <span class="hljs-number">10000</span>,
    <span class="hljs-attr">"seed"</span>: <span class="hljs-number">5681401</span>,
    <span class="hljs-attr">"field"</span>: <span class="hljs-number">0.0</span>,
    <span class="hljs-attr">"temperature"</span>: {
        <span class="hljs-attr">"start"</span>: <span class="hljs-number">1500.0</span>,
        <span class="hljs-attr">"final"</span>: <span class="hljs-number">1.0</span>,
        <span class="hljs-attr">"points"</span>: <span class="hljs-number">100</span>
    }
}
</code></pre>
<ul>
<li>Sample file (<a class="Link" href="sample.dat" target="_blank">sample.dat</a>): This file corresponds to a Fe bulk with BCC structure, periodic boundary conditions and an edge length of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> muc. The name of this file must match the filename in the path of the <code>sample</code> attribute in the configuration file. The construction of this file can be found in the <a href="/vegas/tutorials/system-building/building-a-bulk-system/">Building a bulk system</a> tutorial.</li>
<li>Anisotropy file (<a class="Link" href="anisotropy.dat" target="_blank">anisotropy.dat</a>): Cubic anisotropy is considered.  The name of this file must match the filename in the path of the “anisotropy” attribute in the configuration file. The construction of this file can be found in the <a href="/vegas/tutorials/system-building/building-a-bulk-system/">Building a bulk system</a> tutorial.</li>
<li>Initial state file: In this simulation the system is initialized with a random state; therefore, no initial state file is required.</li>
</ul>
<p>With all the files placed in the same folder, open a terminal, change directory to the folder and type <code>ls</code>. The next list should appear:</p>
<pre><code class="language-shell">anisotropy.dat  config.json  sample.dat
</code></pre>
<p>Then, we can start the simulation by executing:</p>
<pre><code class="language-shell">vegas config.json
</code></pre>
<p>A message like this should appear:</p>
<p><img src="vegas_console.png" alt="vegas_console.png"></p>
<p>Once the simulation is completed, an output file (<code>results.h5</code>) with a size of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn><mn>2</mn></mrow><annotation encoding="application/x-tex">52</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">2</span></span></span></span> MB is generated. This file contains all the history of the simulation, from where the magnetic properties of the system can be extracted and analyzed.</p>
<h2>Data analysis</h2>
<p>The next python script is created to produce plots of the temperature dependence of the magnetization, susceptibility, specific heat and internal energy of the system, and finally, the time evolution of the magnetic moments.</p>
<p>Import the required libraries:</p>
<ul>
<li><a href="http://www.numpy.org/">numpy</a> handles numeric arrays and mathematical operations.</li>
<li><a href="https://matplotlib.org/api/pyplot_api.html">pyplot</a> provides a MATLAB-like plotting framework.</li>
<li><a href="https://www.h5py.org/">h5py</a> provides both a high- and low-level interface to the HDF5 library.</li>
</ul>
<pre><code class="language-python"><span class="hljs-keyword">import</span> numpy
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot
<span class="hljs-keyword">import</span> h5py
</code></pre>
<p>Load the output file into a structure called <code>dataset</code>.</p>
<pre><code class="language-python">dataset = h5py.File(<span class="hljs-string">"results.h5"</span>, mode=<span class="hljs-string">"r"</span>)
print(dataset)
</code></pre>
<pre><code>&lt;HDF5 file &quot;results.h5&quot; (mode r)&gt;
</code></pre>
<p>If we cast the structure <code>dataset</code>, the set of variables in the output file is printed, as observed with HDFView.</p>
<pre><code class="language-python">print(list(dataset))
</code></pre>
<pre><code>['Fe_x', 'Fe_y', 'Fe_z', 'energy', 'field', 'finalstates', 'magnetization_x', 'magnetization_y', 'magnetization_z', 'positions', 'temperature', 'types']
</code></pre>
<p>The magnetization is stored by type and spatial components. <code>Fe_x</code>, <code>Fe_y</code> and <code>Fe_z</code> are the magnetization of sites of type Fe in the x, y and z direction, respectively. In this case, these values are equal to the spatial components of the total magnetization, <code>magnetization_x</code>, <code>magnetization_y</code> and <code>magnetization_z</code>, because there is just an ion type.</p>
<p>It is possible to retrieve each variable using the method <code>get</code>, which, if printed, shows the dimension (shape) of the variable.</p>
<pre><code class="language-python">print(dataset.get(<span class="hljs-string">"Fe_x"</span>))
</code></pre>
<pre><code>&lt;HDF5 dataset &quot;Fe_x&quot;: shape (100, 10000), type &quot;&lt;f8&quot;&gt;
</code></pre>
<p>The dimension of <code>magnetization</code> and <code>energy</code> are (points, MCS), where points are the number of temperature/magnetic field pairs and MCS is the number of Monte Carlo steps. Therefore, the dimension of <code>temperature</code> and <code>field</code> is (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span>, ).</p>
<pre><code class="language-python">print(dataset.get(<span class="hljs-string">"temperature"</span>))
print(dataset.get(<span class="hljs-string">"field"</span>))
</code></pre>
<pre><code>&lt;HDF5 dataset &quot;temperature&quot;: shape (100,), type &quot;&lt;f8&quot;&gt;
&lt;HDF5 dataset &quot;field&quot;: shape (100,), type &quot;&lt;f8&quot;&gt;
</code></pre>
<p>Handling these variables as numpy arrays facilitates the calculations. Also, using the method <code>attrs</code> the attributes of the <code>dataset</code> can be retrieved, which in this case are <code>mcs</code> (number of Monte Carlo steps), <code>seed</code> (random number seed) and <code>kb</code> (Boltzmann constant).</p>
<pre><code class="language-python">print(dataset.attrs)
print(list(dataset.attrs))
</code></pre>
<pre><code>&lt;Attributes of HDF5 object at 139710318743128&gt;
['mcs', 'seed', 'kb']
</code></pre>
<pre><code class="language-python">mcs = dataset.attrs[<span class="hljs-string">"mcs"</span>]
seed = dataset.attrs[<span class="hljs-string">"seed"</span>]
kb = dataset.attrs[<span class="hljs-string">"kb"</span>]
print(mcs, seed, kb)
</code></pre>
<pre><code>10000 5681401 0.08618
</code></pre>
<p>The number of ions can be obtained from the length of the variable <code>positions</code>, which stores the position of every site.</p>
<pre><code class="language-python">num_sites = len(dataset.get(<span class="hljs-string">"positions"</span>))
print(num_sites)
</code></pre>
<pre><code>250
</code></pre>
<p>Load the variables of interest discarding half of the MCS to ensure equilibrium.</p>
<pre><code class="language-python">tau = mcs // <span class="hljs-number">2</span>
energy = dataset.get(<span class="hljs-string">"energy"</span>)[:, tau:]
mag_x = dataset.get(<span class="hljs-string">"magnetization_x"</span>)[:, tau:]
mag_y = dataset.get(<span class="hljs-string">"magnetization_y"</span>)[:, tau:]
mag_z = dataset.get(<span class="hljs-string">"magnetization_z"</span>)[:, tau:]
</code></pre>
<p>These variables has a dimension of (100, 5000).</p>
<pre><code class="language-python">print(energy.shape)
print(mag_x.shape)
print(mag_y.shape)
print(mag_z.shape)
</code></pre>
<pre><code>(100, 5000)
(100, 5000)
(100, 5000)
(100, 5000)
</code></pre>
<p>Compute the total magnetization.</p>
<pre><code class="language-python">mag = numpy.linalg.norm(numpy.array([mag_x, mag_y, mag_z]), axis=<span class="hljs-number">0</span>)
print(mag.shape)
</code></pre>
<pre><code>(100, 5000)
</code></pre>
<p>Compute the mean values normalized by the number of sites.</p>
<pre><code class="language-python">energy_mean = numpy.mean(energy, axis=<span class="hljs-number">1</span>) / num_sites
mag_mean = numpy.mean(mag, axis=<span class="hljs-number">1</span>) / num_sites
</code></pre>
<p>Load the variable <code>temperature</code>.</p>
<pre><code class="language-python">temperature = dataset.get(<span class="hljs-string">"temperature"</span>)[:]
</code></pre>
<p>Plot the total magnetization and energy as function of temperature.</p>
<pre><code class="language-python">fig = pyplot.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">6</span>))

ax1 = fig.add_subplot(<span class="hljs-number">121</span>)
ax1.plot(temperature, mag_mean, lw=<span class="hljs-number">2</span>, color=<span class="hljs-string">"crimson"</span>)
ax1.set_xlabel(<span class="hljs-string">r"$T \ \rm [K]$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.set_ylabel(<span class="hljs-string">r"$M$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.grid()

ax2 = fig.add_subplot(<span class="hljs-number">122</span>)
ax2.plot(temperature, energy_mean, lw=<span class="hljs-number">2</span>, color=<span class="hljs-string">"royalblue"</span>)
ax2.set_xlabel(<span class="hljs-string">r"$T \ \rm [K]$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.set_ylabel(<span class="hljs-string">r"$E$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.grid()

pyplot.tight_layout()
pyplot.show()
</code></pre>
<p><img src="output_33_0.png" alt="png"></p>
<p>The susceptibility and specific heat can be computed according to:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mi>v</mi></msub><mo>=</mo><mfrac><mrow><mrow><mo fence="true">&lt;</mo><msup><mi>E</mi><mn>2</mn></msup><mo fence="true">&gt;</mo></mrow><mo>−</mo><msup><mrow><mo fence="true">&lt;</mo><mi>E</mi><mo fence="true">&gt;</mo></mrow><mn>2</mn></msup></mrow><mrow><msub><mi>k</mi><mi>B</mi></msub><msup><mi>T</mi><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mrow><mo fence="true">(</mo><mi>E</mi><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>k</mi><mi>B</mi></msub><msup><mi>T</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">C_v = \dfrac{\left&lt;E^2\right&gt; - \left&lt;E\right&gt;^2}{k_B T^2} = \dfrac{var\left(E\right)}{k_B T^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.4260099999999998em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class="mbin">−</span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">⟨</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">⟩</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>
<p>and</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>χ</mi><mo>=</mo><mfrac><mrow><mrow><mo fence="true">&lt;</mo><msup><mi>M</mi><mn>2</mn></msup><mo fence="true">&gt;</mo></mrow><mo>−</mo><msup><mrow><mo fence="true">&lt;</mo><mi>M</mi><mo fence="true">&gt;</mo></mrow><mn>2</mn></msup></mrow><mrow><msub><mi>k</mi><mi>B</mi></msub><mi>T</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>v</mi><mi>a</mi><mi>r</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>k</mi><mi>B</mi></msub><mi>T</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\chi = \dfrac{\left&lt;M^2\right&gt; - \left&lt;M\right&gt;^2}{k_B T} = \dfrac{var\left(M\right)}{k_B T}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.4260099999999998em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">χ</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">⟨</span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">⟩</span></span></span><span class="mbin">−</span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">⟨</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">⟩</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">​</span></span>​</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">var</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span></span></span></span> is the variance.</p>
<pre><code class="language-python">Cv = numpy.std(energy, axis=<span class="hljs-number">1</span>)**<span class="hljs-number">2</span> / (kb * temperature**<span class="hljs-number">2</span>)
X = numpy.std(mag, axis=<span class="hljs-number">1</span>)**<span class="hljs-number">2</span> / (kb * temperature)
</code></pre>
<pre><code class="language-python">fig = pyplot.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">6</span>))

ax1 = fig.add_subplot(<span class="hljs-number">121</span>)
ax3 = ax1.twinx()
ax1.plot(temperature, mag_mean, lw=<span class="hljs-number">2</span>, color=<span class="hljs-string">"crimson"</span>, label=<span class="hljs-string">r"$M$"</span>)
ax3.plot(temperature, X, lw=<span class="hljs-number">2</span>, color=<span class="hljs-string">"black"</span>, label=<span class="hljs-string">r"$\chi$"</span>)
ax1.set_xlabel(<span class="hljs-string">r"$T \ \rm [K]$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.set_ylabel(<span class="hljs-string">r"$M$"</span>, fontsize=<span class="hljs-number">20</span>)
ax3.set_ylabel(<span class="hljs-string">r"$\chi$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.grid()
ax1.legend(loc=<span class="hljs-number">3</span>, fontsize=<span class="hljs-number">20</span>)
ax3.legend(loc=<span class="hljs-number">1</span>, fontsize=<span class="hljs-number">20</span>)

ax2 = fig.add_subplot(<span class="hljs-number">122</span>)
ax4 = ax2.twinx()
ax2.plot(temperature, energy_mean, lw=<span class="hljs-number">2</span>, color=<span class="hljs-string">"royalblue"</span>, label=<span class="hljs-string">r"$E$"</span>)
ax4.plot(temperature, Cv, lw=<span class="hljs-number">2</span>, color=<span class="hljs-string">"black"</span>, label=<span class="hljs-string">r"$C_v$"</span>)
ax2.set_xlabel(<span class="hljs-string">r"$T \ \rm [K]$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.set_ylabel(<span class="hljs-string">r"$E$"</span>, fontsize=<span class="hljs-number">20</span>)
ax4.set_ylabel(<span class="hljs-string">r"$C_v$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.grid()
ax2.legend(loc=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">20</span>)
ax4.legend(loc=<span class="hljs-number">5</span>, fontsize=<span class="hljs-number">20</span>)

pyplot.tight_layout()
pyplot.show()
</code></pre>
<p><img src="output_36_0.png" alt="png"></p>
<p>The phase transition is close to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>5</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">1050</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span>, which is close to the Curie temperature of Fe (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>4</mn><mn>3</mn></mrow><annotation encoding="application/x-tex">1043</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">4</span><span class="mord mathrm">3</span></span></span></span> K).</p>
<p>Finally, in order to visualize the temperature evolution of the magnetic moments, load the variable <code>finalstates</code>.</p>
<pre><code class="language-python">finalstates = dataset.get(<span class="hljs-string">"finalstates"</span>)[:]
positions = dataset.get(<span class="hljs-string">"positions"</span>)[:]
print(finalstates.shape)
print(positions.shape)
</code></pre>
<pre><code>(100, 250, 3)
(250, 3)
</code></pre>
<p>The dimension of <code>finalstates</code> is (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mn>5</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">250</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span>), which corresponds to (points, num_sites, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span>), where points is the number of temperature/magnetic field pairs, num_sites is the number of sites and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span> is the number of spatial components <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span></span></span></span>. In a similar way, <code>positions</code> has a dimension of (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mn>5</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">250</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">5</span><span class="mord mathrm">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span>), which corresponds to (num_sites, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span>).</p>
<p>Visualize the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">zy</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span> projection of the final state at the last value of temperature (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span> K).</p>
<pre><code class="language-python">ind = <span class="hljs-number">-1</span>
pyplot.figure()
pyplot.scatter(positions[:, <span class="hljs-number">0</span>], positions[:, <span class="hljs-number">2</span>], lw=<span class="hljs-number">0</span>, color=<span class="hljs-string">"royalblue"</span>, alpha=<span class="hljs-number">0.2</span>)
quivers = pyplot.quiver(positions[:, <span class="hljs-number">0</span>], positions[:, <span class="hljs-number">2</span>],
                        finalstates[ind, :, <span class="hljs-number">0</span>], finalstates[ind, :, <span class="hljs-number">2</span>], finalstates[ind, :, <span class="hljs-number">1</span>],
                        pivot=<span class="hljs-string">"middle"</span>, width=<span class="hljs-number">0.008</span>, scale=<span class="hljs-number">10</span>, lw=<span class="hljs-number">0.5</span>, clim=(<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>))
cb = pyplot.colorbar(quivers)
cb.set_label(<span class="hljs-string">r"$S_y$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.xlabel(<span class="hljs-string">r"$x$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.ylabel(<span class="hljs-string">r"$z$"</span>, fontsize=<span class="hljs-number">20</span>)
pyplot.title(<span class="hljs-string">r"$T = %.1f \ \rm K$"</span> % temperature[ind], fontsize=<span class="hljs-number">20</span>)
pyplot.gca().set_aspect(<span class="hljs-string">"equal"</span>)
pyplot.show()
</code></pre>
<p><img src="output_40_0.png" alt="png"></p>
<hr>
<hr>
<ul>
<li>
<p><a href="/vegas/">Home</a></p>
</li>
<li>
<p><a href="/vegas/model-and-method/">Model and method</a></p>
</li>
<li>
<p><a href="/vegas/installation/">Installation</a></p>
</li>
<li>
<p><a href="/vegas/system-building/">System building</a></p>
</li>
<li>
<p><a href="/vegas/simulation-and-data-analysis/">Simulation and data analysis</a></p>
</li>
<li>
<p><a href="/vegas/tutorials/">Tutorials</a></p>
</li>
</ul>
</div></div><span style="display:block;clear:both;" data-reactid="30"> </span></div><div class="bottomText" data-reactid="31"><div data-reactid="32"><!-- react-text: 33 -->PCM Computational Applications, designed by:<!-- /react-text --><a class="link" href="/people/jdalzatec/" data-reactid="34">jdalzatec</a><!-- react-text: 35 -->,<!-- /react-text --><a class="link" href="/people/dasabogals/" data-reactid="36">dasabogals</a><!-- react-text: 37 -->,<!-- /react-text --><a class="link" href="/people/odarbelaeze/" data-reactid="38">odarbelaeze</a></div></div></div></div><script src="/bundle.js?t=1529681161071"></script></body></html>