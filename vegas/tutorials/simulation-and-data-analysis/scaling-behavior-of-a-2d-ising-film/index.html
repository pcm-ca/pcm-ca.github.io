<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true">PCM Computational Applications | Scaling behavior of a 2D Ising film</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.65 'Arvo','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Arvo','sans-serif';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:2.25rem;line-height:2.475rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.62671rem;line-height:2.475rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.38316rem;line-height:1.65rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.65rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.85028rem;line-height:1.65rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.78405rem;line-height:1.65rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}ul{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.65rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:1rem;line-height:1.65rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}blockquote{margin-left:1.65rem;margin-right:1.65rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.65rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.65rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}li > ul{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.65rem / 2);}code{font-size:0.85rem;line-height:1.65rem;}kbd{font-size:0.85rem;line-height:1.65rem;}samp{font-size:0.85rem;line-height:1.65rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.1rem;padding-right:1.1rem;padding-top:0.825rem;padding-bottom:calc(0.825rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:" ";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Arvo:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/><style>.warning{color:#9f6000;background-color:#feefb3;padding:18px}.warning:before{content:"\26A0";margin-right:9px}.rfc-page pre{font-family:inherit}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><div id="react-mount"><div data-reactroot="" data-reactid="1" data-react-checksum="1332349125"><p style="background:#B9BDEF;border-bottom:2px solid black;" data-reactid="2"><div style="max-width:80%;margin-left:auto;margin-right:auto;padding-top:0;padding:0.825rem 1.2375rem;padding-bottom:10px;display:flex;flex-direction:column;text-align:center;" data-reactid="3"><a class="link-logo-and-name-pcm" title="Home" style="color:black;text-decoration:none;font-size:40px;font-weight:bold;margin-bottom:0rem;" href="/" data-reactid="4"><div class="logo-and-name" style="max-width:960px;margin-left:auto;margin-right:auto;" data-reactid="5"><img class="logo-pcm" src="/android-icon-72x72.png" alt="" data-reactid="6"/><div class="name-pcm" data-reactid="7">PCM Computational Applications</div><img class="logo-un" src="/images/logo-un.png" alt="" data-reactid="8"/><span style="display:block;clear:both;" data-reactid="9"> </span></div></a><nav data-reactid="10"><ul data-reactid="11"><li data-reactid="12"><a class="link-bold" href="/people/" data-reactid="13">People</a></li><li data-reactid="14"><a class="link-bold" href="/research/" data-reactid="15">Research</a></li><li data-reactid="16"><a class="link-bold" href="/publications/" data-reactid="17">Publications</a></li><li data-reactid="18"><a class="link-bold" href="/vegas/" data-reactid="19">𝕍egas</a></li><li data-reactid="20"><a class="link-bold" href="/resources/" data-reactid="21">Resources</a></li><li data-reactid="22"><a class="link-bold" href="/contact/" data-reactid="23">Contact us</a></li></ul></nav><span style="display:block;clear:both;" data-reactid="24"> </span></div></p><div style="max-width:80%;margin-left:auto;margin-right:auto;padding:0rem 1.2375rem;padding-top:0;" data-reactid="25"><div class="markdown" data-reactid="26"><!-- react-empty: 27 --><h1 data-reactid="28">Scaling behavior of a 2D Ising film</h1><div data-reactid="29"><p>In this tutorial, we explain how to simulate the scaling behavior of a 2D Ising film.</p>
<p>The system in consideration is a ferromagnetic 2D Ising film with an edge length of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> magnetic unit cells (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>u</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">muc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">u</span><span class="mord mathit">c</span></span></span></span>). Only nearest neighbors exchange interaction was considered. The following parameters were used:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">J = 1.0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">k = 0.0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mrow><mi mathvariant="bold">S</mi></mrow><mi mathvariant="normal">∣</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">|\mathbf{S}| = 1.0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">S</span></span><span class="mord mathrm">∣</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>=</mo><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">L = 10
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">L</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span></span>
<center>Spin update policy: flip</center>
<br/>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∣</mi><mrow><mi mathvariant="bold">S</mi></mrow><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|\mathbf{S}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">∣</span><span class="mord textstyle uncramped"><span class="mord mathbf">S</span></span><span class="mord mathrm">∣</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">L</span></span></span></span> are the nearest neighbors exchange interaction constant, anisotropy constant, spin moment and edge length of the 2D Ising system, respectively.</p>
<p>Several 2D Ising films, with edge lengths varying from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span>, were cooled down from a high to a low temperature measuring different thermodynamic quantities. The computed thermodynamic quantities include the magnetization <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mi>M</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(M\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, magnetic susceptibility <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mi>χ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(\chi\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit">χ</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, specific heat <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>C</mi><mi>v</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(C_v\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, first order cumulant of the energy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>C</mi><mi>u</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(C_u\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span> and first and second order cumulants of the order parameter. (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">V_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> y <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">V_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>). Using these quantities is possible to compute the critical exponents of a magnetic system. For more information about thermodynamic quantities and critical exponents, go to <a href="https://www.sciencedirect.com/science/article/pii/S0039602808007620">X.T. Pham Phu et al.</a> Finally, plots of the thermodynamic quantities for the different system sizes are produced.</p>
<h2>Simulation</h2>
<p>As explained in the <a href="/vegas/simulation-and-data-analysis/">simulation section</a>, four input files with established formats are used to perform a simulation:</p>
<ul>
<li>Configuration files: In order to compute mean values of the thermodynamic quantities, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> configurations files per sample will be created using python.</li>
<li>Sample files (<a class="Link" href="samples.zip" target="_blank">samples.zip</a>): <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> sample files of 2D Ising films with edge lengths varying from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> muc are considered. The construction of these sample files was made using the scrip developed in the <a href="/vegas/tutorials/system-building/building-a-2d-ising-film/">Building a 2D Ising film</a> tutorial.</li>
<li>Anisotropy and initial state files: In this simulation, neither anisotropy nor magnetization initial state were considered.</li>
</ul>
<p>Let’s write a python script to generate the configuration files for each sample file.</p>
<p>Import the required libraries</p>
<ul>
<li><a href="https://docs.python.org/3.6/library/glob.html">glob</a> finds all the pathnames matching a specified pattern according to the rules used by the Unix shell.</li>
<li><a href="https://docs.python.org/2/library/json.html">json</a> is used to dump a dictionary into a JSON file.</li>
<li><a href="http://www.numpy.org/">numpy</a> handles numeric arrays and mathematical operations.</li>
</ul>
<pre><code class="language-python"><span class="hljs-keyword">import</span> glob
<span class="hljs-keyword">import</span> json
<span class="hljs-keyword">import</span> numpy
</code></pre>
<p>Save the sample files in a list named <code>samples</code> and print this list.</p>
<pre><code class="language-python">samples = sorted(glob.glob(<span class="hljs-string">"*.dat"</span>))
print(samples)
</code></pre>
<pre><code>['sample_L_10.dat', 'sample_L_100.dat', 'sample_L_20.dat', 'sample_L_30.dat', 'sample_L_40.dat', 'sample_L_50.dat', 'sample_L_60.dat', 'sample_L_70.dat', 'sample_L_80.dat', 'sample_L_90.dat']
</code></pre>
<p>Create a dictionary with the general simulation parameters. The other simulation parameters will be inputed later.</p>
<pre><code class="language-python">base_config = {
    <span class="hljs-string">"kb"</span>: <span class="hljs-number">1.0</span>,
    <span class="hljs-string">"mcs"</span>: <span class="hljs-number">50000</span>,
    <span class="hljs-string">"field"</span>: <span class="hljs-number">0.0</span>,
    <span class="hljs-string">"temperature"</span>: {
        <span class="hljs-string">"start"</span>: <span class="hljs-number">3.0</span>,
        <span class="hljs-string">"final"</span>: <span class="hljs-number">0.01</span>,
        <span class="hljs-string">"points"</span>: <span class="hljs-number">200</span>
    }
}
</code></pre>
<p>Use a <code>for</code> loop to create <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span> configuration files for each sample file with different random number seed. Then, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> configuration files are created.</p>
<pre><code class="language-python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):
    <span class="hljs-keyword">for</span> sample <span class="hljs-keyword">in</span> samples:
        sample_dict = base_config.copy()
        sample_dict[<span class="hljs-string">"sample"</span>] = sample
        sample_dict[<span class="hljs-string">"out"</span>] = sample.replace(<span class="hljs-string">".dat"</span>, <span class="hljs-string">"_%i_.h5"</span> % i)
        sample_dict[<span class="hljs-string">"seed"</span>] = numpy.random.randint(<span class="hljs-number">10000</span>, <span class="hljs-number">10000000</span>)
        
        <span class="hljs-keyword">with</span> open(sample.replace(<span class="hljs-string">".dat"</span>, <span class="hljs-string">"_%i_.json"</span> % i), mode=<span class="hljs-string">"w"</span>) <span class="hljs-keyword">as</span> json_file:
            json.dump(sample_dict, json_file)
</code></pre>
<pre><code class="language-python">json_files = sorted(glob.glob(<span class="hljs-string">"*.json"</span>))
</code></pre>
<pre><code class="language-python">print(json_files)
</code></pre>
<pre><code>['sample_L_100_0_.json', 'sample_L_100_1_.json', 'sample_L_100_2_.json', 'sample_L_100_3_.json', 'sample_L_100_4_.json', 'sample_L_100_5_.json', 'sample_L_100_6_.json', 'sample_L_100_7_.json', 'sample_L_100_8_.json', 'sample_L_100_9_.json', 'sample_L_10_0_.json', 'sample_L_10_1_.json', 'sample_L_10_2_.json', 'sample_L_10_3_.json', 'sample_L_10_4_.json', 'sample_L_10_5_.json', 'sample_L_10_6_.json', 'sample_L_10_7_.json', 'sample_L_10_8_.json', 'sample_L_10_9_.json', 'sample_L_20_0_.json', 'sample_L_20_1_.json', 'sample_L_20_2_.json', 'sample_L_20_3_.json', 'sample_L_20_4_.json', 'sample_L_20_5_.json', 'sample_L_20_6_.json', 'sample_L_20_7_.json', 'sample_L_20_8_.json', 'sample_L_20_9_.json', 'sample_L_30_0_.json', 'sample_L_30_1_.json', 'sample_L_30_2_.json', 'sample_L_30_3_.json', 'sample_L_30_4_.json', 'sample_L_30_5_.json', 'sample_L_30_6_.json', 'sample_L_30_7_.json', 'sample_L_30_8_.json', 'sample_L_30_9_.json', 'sample_L_40_0_.json', 'sample_L_40_1_.json', 'sample_L_40_2_.json', 'sample_L_40_3_.json', 'sample_L_40_4_.json', 'sample_L_40_5_.json', 'sample_L_40_6_.json', 'sample_L_40_7_.json', 'sample_L_40_8_.json', 'sample_L_40_9_.json', 'sample_L_50_0_.json', 'sample_L_50_1_.json', 'sample_L_50_2_.json', 'sample_L_50_3_.json', 'sample_L_50_4_.json', 'sample_L_50_5_.json', 'sample_L_50_6_.json', 'sample_L_50_7_.json', 'sample_L_50_8_.json', 'sample_L_50_9_.json', 'sample_L_60_0_.json', 'sample_L_60_1_.json', 'sample_L_60_2_.json', 'sample_L_60_3_.json', 'sample_L_60_4_.json', 'sample_L_60_5_.json', 'sample_L_60_6_.json', 'sample_L_60_7_.json', 'sample_L_60_8_.json', 'sample_L_60_9_.json', 'sample_L_70_0_.json', 'sample_L_70_1_.json', 'sample_L_70_2_.json', 'sample_L_70_3_.json', 'sample_L_70_4_.json', 'sample_L_70_5_.json', 'sample_L_70_6_.json', 'sample_L_70_7_.json', 'sample_L_70_8_.json', 'sample_L_70_9_.json', 'sample_L_80_0_.json', 'sample_L_80_1_.json', 'sample_L_80_2_.json', 'sample_L_80_3_.json', 'sample_L_80_4_.json', 'sample_L_80_5_.json', 'sample_L_80_6_.json', 'sample_L_80_7_.json', 'sample_L_80_8_.json', 'sample_L_80_9_.json', 'sample_L_90_0_.json', 'sample_L_90_1_.json', 'sample_L_90_2_.json', 'sample_L_90_3_.json', 'sample_L_90_4_.json', 'sample_L_90_5_.json', 'sample_L_90_6_.json', 'sample_L_90_7_.json', 'sample_L_90_8_.json', 'sample_L_90_9_.json']
</code></pre>
<pre><code class="language-python">print(len(json_files))
</code></pre>
<pre><code>100
</code></pre>
<p>Now, each configuration file can be used to run a simulation. However, this long process can be optimized by writing all the possible commands in a file, named <code>commands.sh</code> in this case, and then executing in parallel each command. This is possible because all the simulations are independent. The possible commands should look like this</p>
<pre><code class="language-shell">vegas FILE.json &gt; FILE.log
</code></pre>
<p>Then, the output is stored in “.log” files that can be monitored independently.</p>
<pre><code class="language-python">commands_file = open(<span class="hljs-string">"commands.sh"</span>, mode=<span class="hljs-string">"w"</span>)
<span class="hljs-keyword">for</span> json_file <span class="hljs-keyword">in</span> json_files:
    commands_file.write(<span class="hljs-string">"vegas %s &gt; %s\n"</span> % (json_file, json_file.replace(<span class="hljs-string">".json"</span>, <span class="hljs-string">".log"</span>)))
commands_file.close()
</code></pre>
<p>To run the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> simulations in parallel, we provide a simple python script (click <a class="Link" href="pool.py" target="_blank">here</a> to download), which takes in a commands file and the number of processes to be executed in parallel.  By default, the number of processes is equal to the number of threads of the computer. To run this script is required to install the library “click”, which is part of the python packages repository. To install “click”, run</p>
<pre><code class="language-shell">pip install click
</code></pre>
<p>or using conda</p>
<pre><code class="language-shell">conda install click
</code></pre>
<p>Finally, the simulation can be executed in parallel by running</p>
<pre><code class="language-shell">python pool.py commands.sh
</code></pre>
<p>Once this process ends, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mn>0</mn><mn>0</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span> results output files, with a size close to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>5</mn><mi mathvariant="normal">.</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">5.3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span></span></span></span> GB, were generated.</p>
<h2>Data analysis</h2>
<p>Import the required libraries:</p>
<ul>
<li><a href="http://www.numpy.org/">numpy</a> handles numeric arrays and mathematical operations.</li>
<li><a href="https://www.h5py.org/">h5py</a> provides both a high- and low-level interface to the HDF5 library.</li>
<li><a href="https://matplotlib.org/">matplotlib</a> produces figures.</li>
<li><a href="https://docs.python.org/3.6/library/glob.html">glob</a> finds all the pathnames matching a specified pattern according to the rules used by the Unix shell.</li>
</ul>
<pre><code class="language-python"><span class="hljs-keyword">import</span> numpy
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot
<span class="hljs-keyword">import</span> h5py
<span class="hljs-keyword">import</span> glob
</code></pre>
<pre><code>/usr/local/lib/python3.5/dist-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
</code></pre>
<p>Create an array of the edge lengths of the systems.</p>
<pre><code class="language-python">L_arr = range(<span class="hljs-number">10</span>, <span class="hljs-number">110</span>, <span class="hljs-number">10</span>)
</code></pre>
<p>Create a dictionary of output files, where each key is an edge length (<code>L</code>) and the value its corresponding output files.</p>
<pre><code class="language-python">results_by_L = {L: sorted(glob.glob(<span class="hljs-string">"*_L_%i_*.h5"</span> % L)) <span class="hljs-keyword">for</span> L <span class="hljs-keyword">in</span> L_arr}
</code></pre>
<p>For instance, let’s print <code>results_by_L[10]</code>.</p>
<pre><code class="language-python">print(results_by_L[<span class="hljs-number">10</span>])
</code></pre>
<pre><code>['sample_L_10_0_.h5', 'sample_L_10_1_.h5', 'sample_L_10_2_.h5', 'sample_L_10_3_.h5', 'sample_L_10_4_.h5', 'sample_L_10_5_.h5', 'sample_L_10_6_.h5', 'sample_L_10_7_.h5', 'sample_L_10_8_.h5', 'sample_L_10_9_.h5']
</code></pre>
<p>Create a function that takes the <code>filename</code> and returns the array of temperatures <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mi>T</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(T\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, magnetizations <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mi>M</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(M\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, susceptibilities <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mi>χ</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(\chi\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathit">χ</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, specific heats <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>C</mi><mi>v</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(C_v\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span>, firs order cumulants of the energy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>C</mi><mi>u</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\left(C_u\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span></span></span></span> and first and second order cumulants of the order parameter (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">V_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span> y <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">V_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.22222em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>). Then, compute the averages discarding half of the Monte Carlo steps for relaxation.</p>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_T_M_X_Cv_Cu_V1_V2</span><span class="hljs-params">(filename)</span>:</span>
    dataset = h5py.File(filename, mode=<span class="hljs-string">"r"</span>)
    mcs = dataset.attrs[<span class="hljs-string">"mcs"</span>]
    tau = mcs // <span class="hljs-number">2</span>
    kb = dataset.attrs[<span class="hljs-string">"kb"</span>]
    num_sites = len(dataset.get(<span class="hljs-string">"positions"</span>))
    mag_z = numpy.abs(dataset.get(<span class="hljs-string">"magnetization_z"</span>)[:, tau:])
    energy = dataset.get(<span class="hljs-string">"energy"</span>)[:, tau:]
    temperature = dataset.get(<span class="hljs-string">"temperature"</span>)[:]
    
    mag_mean = numpy.mean(mag_z, axis=<span class="hljs-number">1</span>) / num_sites
    X = numpy.std(mag_z, axis=<span class="hljs-number">1</span>) ** <span class="hljs-number">2</span> / (kb * temperature * num_sites)
    Cv = numpy.std(energy, axis=<span class="hljs-number">1</span>)**<span class="hljs-number">2</span> / (kb * temperature * temperature * num_sites)
    Cu = <span class="hljs-number">1</span> - numpy.mean(energy**<span class="hljs-number">4</span>, axis=<span class="hljs-number">1</span>) / (<span class="hljs-number">3</span> * numpy.mean(energy**<span class="hljs-number">2</span>, axis=<span class="hljs-number">1</span>)**<span class="hljs-number">2</span>)
    V1 = numpy.mean(energy, axis=<span class="hljs-number">1</span>) - numpy.mean(mag_z * energy, axis=<span class="hljs-number">1</span>) / numpy.mean(mag_z, axis=<span class="hljs-number">1</span>)
    V2 = numpy.mean(energy, axis=<span class="hljs-number">1</span>) - numpy.mean(mag_z**<span class="hljs-number">2</span> * energy, axis=<span class="hljs-number">1</span>) / numpy.mean(mag_z**<span class="hljs-number">2</span>, axis=<span class="hljs-number">1</span>)
    
    dataset.close()
    
    <span class="hljs-keyword">return</span> temperature, mag_mean, X, Cv, Cu, V1, V2
</code></pre>
<p>Loop over all the edge lengths (<code>L</code>) and its corresponding output files, and create dictionaries of the mean values and standard deviations for the computed thermodynamic quantities.</p>
<pre><code class="language-python">M_mean_dict = dict()
M_std_dict = dict()
X_mean_dict = dict()
X_std_dict = dict()
Cv_mean_dict = dict()
Cv_std_dict = dict()
Cu_mean_dict = dict()
Cu_std_dict = dict()
V1_mean_dict = dict()
V1_std_dict = dict()
V2_mean_dict = dict()
V2_std_dict = dict()

<span class="hljs-keyword">for</span> L <span class="hljs-keyword">in</span> L_arr:
    M_arr = list()
    X_arr = list()
    Cv_arr = list()
    Cu_arr = list()
    V1_arr = list()
    V2_arr = list()
    <span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> results_by_L[L]:
        T, M, X, Cv, Cu, V1, V2 = get_T_M_X_Cv_Cu_V1_V2(filename)
        M_arr.append(M)
        X_arr.append(X)
        Cv_arr.append(Cv)
        Cu_arr.append(Cu)
        V1_arr.append(V1)
        V2_arr.append(V2)
    
    M_mean_dict[L] = numpy.mean(M_arr, axis=<span class="hljs-number">0</span>)
    M_std_dict[L] = numpy.std(M_arr, axis=<span class="hljs-number">0</span>)
    
    X_mean_dict[L] = numpy.mean(X_arr, axis=<span class="hljs-number">0</span>)
    X_std_dict[L] = numpy.std(X_arr, axis=<span class="hljs-number">0</span>)
    
    Cv_mean_dict[L] = numpy.mean(Cv_arr, axis=<span class="hljs-number">0</span>)
    Cv_std_dict[L] = numpy.std(Cv_arr, axis=<span class="hljs-number">0</span>)
    
    Cu_mean_dict[L] = numpy.mean(Cu_arr, axis=<span class="hljs-number">0</span>)
    Cu_std_dict[L] = numpy.std(Cu_arr, axis=<span class="hljs-number">0</span>)
    
    V1_mean_dict[L] = numpy.mean(V1_arr, axis=<span class="hljs-number">0</span>)
    V1_std_dict[L] = numpy.std(V1_arr, axis=<span class="hljs-number">0</span>)
    
    V2_mean_dict[L] = numpy.mean(V2_arr, axis=<span class="hljs-number">0</span>)
    V2_std_dict[L] = numpy.std(V2_arr, axis=<span class="hljs-number">0</span>)
</code></pre>
<p>Finally, plot all the thermodynamic quantities mean values as function of the temperature for the different system sizes.</p>
<pre><code class="language-python">markers = <span class="hljs-string">"so*&lt;&gt;^vdhh"</span>
cm_subsection = numpy.linspace(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>, len(L_arr))
cmap = pyplot.get_cmap(<span class="hljs-string">"jet"</span>)

fig = pyplot.figure(figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">12</span>))

ax1 = fig.add_subplot(<span class="hljs-number">321</span>)
<span class="hljs-keyword">for</span> i, L <span class="hljs-keyword">in</span> enumerate(L_arr):
    ax1.plot(T, M_mean_dict[L], <span class="hljs-string">"-"</span> + markers[i], label=<span class="hljs-string">r"$L = %s$"</span> % L, color=cmap(cm_subsection[i]))
    ax1.errorbar(T, M_mean_dict[L], yerr=M_std_dict[L], fmt=<span class="hljs-string">"none"</span>, ecolor=<span class="hljs-string">"black"</span>)
ax1.grid()
ax1.legend(loc=<span class="hljs-string">"best"</span>, ncol=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">14</span>)
ax1.set_xlabel(<span class="hljs-string">r"$k_{B}T/J_{ex}$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.set_ylabel(<span class="hljs-string">r"$M$"</span>, fontsize=<span class="hljs-number">20</span>)
ax1.set_ylim(<span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)


ax2 = fig.add_subplot(<span class="hljs-number">322</span>)
<span class="hljs-keyword">for</span> i, L <span class="hljs-keyword">in</span> enumerate(L_arr):
    ax2.plot(T, X_mean_dict[L], <span class="hljs-string">"-"</span> + markers[i], label=<span class="hljs-string">r"$L = %s$"</span> % L, color=cmap(cm_subsection[i]))
    ax2.errorbar(T, X_mean_dict[L], yerr=X_std_dict[L], fmt=<span class="hljs-string">"none"</span>, ecolor=<span class="hljs-string">"black"</span>)
ax2.grid()
ax2.legend(loc=<span class="hljs-string">"best"</span>, ncol=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">14</span>)
ax2.set_xlabel(<span class="hljs-string">r"$k_{B}T/J_{ex}$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.set_ylabel(<span class="hljs-string">r"$\chi$"</span>, fontsize=<span class="hljs-number">20</span>)
ax2.set_ylim(<span class="hljs-number">0.0</span>)


ax3 = fig.add_subplot(<span class="hljs-number">323</span>)
<span class="hljs-keyword">for</span> i, L <span class="hljs-keyword">in</span> enumerate(L_arr):
    ax3.plot(T, Cv_mean_dict[L], <span class="hljs-string">"-"</span> + markers[i], label=<span class="hljs-string">r"$L = %s$"</span> % L, color=cmap(cm_subsection[i]))
    ax3.errorbar(T, Cv_mean_dict[L], yerr=Cv_std_dict[L], fmt=<span class="hljs-string">"none"</span>, ecolor=<span class="hljs-string">"black"</span>)
ax3.grid()
ax3.legend(loc=<span class="hljs-string">"best"</span>, ncol=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">14</span>)
ax3.set_xlabel(<span class="hljs-string">r"$k_{B}T/J_{ex}$"</span>, fontsize=<span class="hljs-number">20</span>)
ax3.set_ylabel(<span class="hljs-string">r"$C_v$"</span>, fontsize=<span class="hljs-number">20</span>)
ax3.set_ylim(<span class="hljs-number">0.0</span>)


ax4 = fig.add_subplot(<span class="hljs-number">324</span>)
<span class="hljs-keyword">for</span> i, L <span class="hljs-keyword">in</span> enumerate(L_arr):
    ax4.plot(T, Cu_mean_dict[L], <span class="hljs-string">"-"</span> + markers[i], label=<span class="hljs-string">r"$L = %s$"</span> % L, color=cmap(cm_subsection[i]))
    ax4.errorbar(T, Cu_mean_dict[L], yerr=Cu_std_dict[L], fmt=<span class="hljs-string">"none"</span>, ecolor=<span class="hljs-string">"black"</span>)
ax4.grid()
ax4.legend(loc=<span class="hljs-string">"best"</span>, ncol=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">14</span>)
ax4.set_xlabel(<span class="hljs-string">r"$k_{B}T/J_{ex}$"</span>, fontsize=<span class="hljs-number">20</span>)
ax4.set_ylabel(<span class="hljs-string">r"$C_u$"</span>, fontsize=<span class="hljs-number">20</span>)


ax5 = fig.add_subplot(<span class="hljs-number">325</span>)
<span class="hljs-keyword">for</span> i, L <span class="hljs-keyword">in</span> enumerate(L_arr):
    ax5.plot(T, V1_mean_dict[L], <span class="hljs-string">"-"</span> + markers[i], label=<span class="hljs-string">r"$L = %s$"</span> % L, color=cmap(cm_subsection[i]))
    ax5.errorbar(T, V1_mean_dict[L], yerr=V1_std_dict[L], fmt=<span class="hljs-string">"none"</span>, ecolor=<span class="hljs-string">"black"</span>)
ax5.grid()
ax5.legend(loc=<span class="hljs-string">"best"</span>, ncol=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">14</span>)
ax5.set_xlabel(<span class="hljs-string">r"$k_{B}T/J_{ex}$"</span>, fontsize=<span class="hljs-number">20</span>)
ax5.set_ylabel(<span class="hljs-string">r"$V_1$"</span>, fontsize=<span class="hljs-number">20</span>)
ax5.set_ylim(<span class="hljs-number">0.0</span>)


ax6 = fig.add_subplot(<span class="hljs-number">326</span>)
<span class="hljs-keyword">for</span> i, L <span class="hljs-keyword">in</span> enumerate(L_arr):
    ax6.plot(T, V2_mean_dict[L], <span class="hljs-string">"-"</span> + markers[i], label=<span class="hljs-string">r"$L = %s$"</span> % L, color=cmap(cm_subsection[i]))
    ax6.errorbar(T, V2_mean_dict[L], yerr=V2_std_dict[L], fmt=<span class="hljs-string">"none"</span>, ecolor=<span class="hljs-string">"black"</span>)
ax6.grid()
ax6.legend(loc=<span class="hljs-string">"best"</span>, ncol=<span class="hljs-number">2</span>, fontsize=<span class="hljs-number">14</span>)
ax6.set_xlabel(<span class="hljs-string">r"$k_{B}T/J_{ex}$"</span>, fontsize=<span class="hljs-number">20</span>)
ax6.set_ylabel(<span class="hljs-string">r"$V_2$"</span>, fontsize=<span class="hljs-number">20</span>)
ax6.set_ylim(<span class="hljs-number">0.0</span>)

pyplot.tight_layout()
pyplot.show()
</code></pre>
<p><img src="output_35_0.png" alt="png"></p>
<hr>
<ul>
<li>
<p><a href="/vegas/">Home</a></p>
</li>
<li>
<p><a href="/vegas/model-and-method/">Model and method</a></p>
</li>
<li>
<p><a href="/vegas/installation/">Installation</a></p>
</li>
<li>
<p><a href="/vegas/system-building/">System building</a></p>
</li>
<li>
<p><a href="/vegas/simulation-and-data-analysis/">Simulation and data analysis</a></p>
</li>
<li>
<p><a href="/vegas/tutorials/">Tutorials</a></p>
</li>
</ul>
</div></div><span style="display:block;clear:both;" data-reactid="30"> </span></div><div class="bottomText" data-reactid="31"><div data-reactid="32"><!-- react-text: 33 -->PCM Computational Applications, designed by:<!-- /react-text --><a class="link" href="/people/jdalzatec/" data-reactid="34">jdalzatec</a><!-- react-text: 35 -->,<!-- /react-text --><a class="link" href="/people/dasabogals/" data-reactid="36">dasabogals</a><!-- react-text: 37 -->,<!-- /react-text --><a class="link" href="/people/odarbelaeze/" data-reactid="38">odarbelaeze</a></div></div></div></div><script src="/bundle.js?t=1529681161071"></script></body></html>