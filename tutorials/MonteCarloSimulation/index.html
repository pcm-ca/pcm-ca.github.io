<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><title data-react-helmet="true">PCM Computational Applications | Construcci√≥n de Programa Monte Carlo para Simulaci√≥n de un sistema Ising 2D</title><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.65 'Arvo','sans-serif';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Arvo','sans-serif';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:2.25rem;line-height:2.475rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.62671rem;line-height:2.475rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1.38316rem;line-height:1.65rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.65rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.85028rem;line-height:1.65rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;color:inherit;font-family:'Montserrat','sans-serif';font-weight:bold;text-rendering:optimizeLegibility;font-size:0.78405rem;line-height:1.65rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}ul{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.65rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:0.85rem;line-height:1.42;background:hsla(0,0%,0%,0.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.65rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;font-size:1rem;line-height:1.65rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}blockquote{margin-left:1.65rem;margin-right:1.65rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.65rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.65rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.65rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}li > ul{margin-left:1.65rem;margin-bottom:calc(1.65rem / 2);margin-top:calc(1.65rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.65rem / 2);}code{font-size:0.85rem;line-height:1.65rem;}kbd{font-size:0.85rem;line-height:1.65rem;}samp{font-size:0.85rem;line-height:1.65rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.1rem;padding-right:1.1rem;padding-top:0.825rem;padding-bottom:calc(0.825rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}tt,code{background-color:hsla(0,0%,0%,0.04);border-radius:3px;font-family:"SFMono-Regular", Consolas,"Roboto Mono","Droid Sans Mono","Liberation Mono",Menlo,Courier,monospace;padding:0;padding-top:0.2em;padding-bottom:0.2em;}pre code{background:none;line-height:1.42;}code:before,code:after,tt:before,tt:after{letter-spacing:-0.2em;content:"¬†";}pre code:before,pre code:after,pre tt:before,pre tt:after{content:"";}</style><link href="//fonts.googleapis.com/css?family=Montserrat:700|Arvo:400,400i,700" rel="stylesheet" type="text/css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"/><style>.warning{color:#9f6000;background-color:#feefb3;padding:18px}.warning:before{content:"\26A0";margin-right:9px}.rfc-page pre{font-family:inherit}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><div id="react-mount"><div data-reactroot="" data-reactid="1" data-react-checksum="-741747244"><p style="background:#B9BDEF;border-bottom:2px solid black;" data-reactid="2"><div style="max-width:80%;margin-left:auto;margin-right:auto;padding-top:0;padding:0.825rem 1.2375rem;padding-bottom:10px;display:flex;flex-direction:column;text-align:center;" data-reactid="3"><a class="link-logo-and-name-pcm" title="Home" style="color:black;text-decoration:none;font-size:40px;font-weight:bold;margin-bottom:0rem;" href="/" data-reactid="4"><div class="logo-and-name" style="max-width:960px;margin-left:auto;margin-right:auto;" data-reactid="5"><img class="logo-pcm" src="/android-icon-72x72.png" alt="" data-reactid="6"/><div class="name-pcm" data-reactid="7">PCM Computational Applications</div><img class="logo-un" src="/images/logo-un.png" alt="" data-reactid="8"/><span style="display:block;clear:both;" data-reactid="9"> </span></div></a><nav data-reactid="10"><ul data-reactid="11"><li data-reactid="12"><a class="link-bold" href="/people/" data-reactid="13">People</a></li><li data-reactid="14"><a class="link-bold" href="/research/" data-reactid="15">Research</a></li><li data-reactid="16"><a class="link-bold" href="/publications/" data-reactid="17">Publications</a></li><li data-reactid="18"><a class="link-bold" href="/vegas/" data-reactid="19">ùïçegas</a></li><li data-reactid="20"><a class="link-bold" href="/resources/" data-reactid="21">Resources</a></li><li data-reactid="22"><a class="link-bold" href="/contact/" data-reactid="23">Contact us</a></li></ul></nav><span style="display:block;clear:both;" data-reactid="24"> </span></div></p><div style="max-width:80%;margin-left:auto;margin-right:auto;padding:0rem 1.2375rem;padding-top:0;" data-reactid="25"><div class="markdown" data-reactid="26"><!-- react-empty: 27 --><h1 data-reactid="28">Construcci√≥n de Programa Monte Carlo para Simulaci√≥n de un sistema Ising 2D</h1><div data-reactid="29"><h6>Todo este tutorial se encuentra en un scritp de ipython notebook. Lo puedes descargar de <a href="MonteCarloIsing2D.ipynb">aqu√≠</a>.</h6>
<p>Este tutorial est√° elaborado con el fin de proporcionar una gu√≠a pr√°ctica para la elaboraci√≥n de un programa Monte Carlo para la simulaci√≥n de un sistema Ising 2D. El programa est√° construido en <strong>python3</strong>. Es cierto que la complejidad del programa es m√≠nima, pero la eficiencia de los ciclos en python es m√≠nima. Es por ello que cabe resaltar que es recomendable emplear otro lenguaje, sea <strong>C++</strong> o <strong>Fortran</strong>, para la implementaci√≥n del paso Monte Carlo y el algoritmo de Metr√≥polis.</p>
<p>El sistema que se desea simular es un Ising 2D, cuyo Hamiltoniano consiste √∫nicamente en el t√©rmino de intercambio</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">H</mi></mrow><mo>=</mo><mo>‚àí</mo><mi>J</mi><msub><mo>‚àë</mo><mrow><mrow><mo fence="true">‚ü®</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">‚ü©</mo></mrow></mrow></msub><msub><mi>œÉ</mi><mrow><mi>i</mi></mrow></msub><msub><mi>œÉ</mi><mrow><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{H}=-J\sum_{\left\langle i,j\right\rangle }\sigma_{i}\sigma_{j}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.00965em;">H</span></span><span class="mrel">=</span><span class="mord">‚àí</span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mop op-limits"><span class="vlist"><span style="top:1.241005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="minner scriptstyle cramped"><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">‚ü®</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="style-wrap reset-scriptstyle scriptstyle uncramped" style="top:0em;">‚ü©</span></span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">‚Äã</span></span><span><span class="op-symbol large-op mop">‚àë</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0.7em;">‚Äã</span></span>‚Äã</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">œÉ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">œÉ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span></span>
<p>donde <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span></span></span></span> es la constante de intercambio y <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>œÉ</mi><mrow><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">œÉ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span> y <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>œÉ</mi><mrow><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\sigma_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">œÉ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span> son los espines de la posici√≥n <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> y <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>, respectivamente.</p>
<p>Para calcular la magnetizaci√≥n se emplea</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>=</mo><msub><mo>‚àë</mo><mrow><mi>i</mi></mrow></msub><msub><mi>œÉ</mi><mrow><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">M=\sum_{i}\sigma_{i}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0500050000000003em;"></span><span class="strut bottom" style="height:2.327674em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span><span class="op-symbol large-op mop">‚àë</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">œÉ</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span></span>
<p>y para el c√°lculo de la susceptibilidad magn√©tica y el calor espec√≠fico se sigue</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>œá</mi><mo>=</mo><mfrac><mrow><mrow><mo fence="true">(</mo><mrow><mo fence="true">‚ü®</mo><msup><mi>M</mi><mrow><mn>2</mn></mrow></msup><mo fence="true">‚ü©</mo></mrow><mo>‚àí</mo><msup><mrow><mo fence="true">‚ü®</mo><mi>M</mi><mo fence="true">‚ü©</mo></mrow><mrow><mn>2</mn></mrow></msup><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>k</mi><mrow><mi>B</mi></mrow></msub><mi>T</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\chi	=	\frac{\left(\left\langle M^{2}\right\rangle -\left\langle M\right\rangle ^{2}\right)}{k_{B}T}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.4260099999999998em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">œá</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">‚ü®</span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">‚ü©</span></span></span><span class="mbin">‚àí</span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">‚ü®</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">‚ü©</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span>‚Äã</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>v</mi></mrow></msub><mo>=</mo><mfrac><mrow><mrow><mo fence="true">(</mo><mrow><mo fence="true">‚ü®</mo><msup><mi>E</mi><mrow><mn>2</mn></mrow></msup><mo fence="true">‚ü©</mo></mrow><mo>‚àí</mo><msup><mrow><mo fence="true">‚ü®</mo><mi>E</mi><mo fence="true">‚ü©</mo></mrow><mrow><mn>2</mn></mrow></msup><mo fence="true">)</mo></mrow></mrow><mrow><msub><mi>k</mi><mrow><mi>B</mi></mrow></msub><msup><mi>T</mi><mrow><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">C_{v}	=	\frac{\left(\left\langle E^{2}\right\rangle -\left\langle E\right\rangle ^{2}\right)}{k_{B}T^{2}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.4260099999999998em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">‚ü®</span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">‚ü©</span></span></span><span class="mbin">‚àí</span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">‚ü®</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">‚ü©</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">‚Äã</span></span>‚Äã</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>
<p>Si quieres puedes descargar el scritp en un ipython notebook <a href="MonteCarloIsing2D.ipynb">aqu√≠</a>.</p>
<h2>Importaci√≥n de librer√≠as</h2>
<pre><code class="language-python"><span class="hljs-keyword">import</span> numpy
<span class="hljs-keyword">from</span> collections <span class="hljs-keyword">import</span> defaultdict
<span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot
<span class="hljs-keyword">import</span> itertools
%matplotlib inline
</code></pre>
<ul>
<li><strong>numpy</strong> se emplea para computaci√≥n cient√≠fica. Esta contiene muchas funciones para c√°lculos num√©ricos.</li>
<li><strong>defaultdict</strong> es una clase para crear diccionarios donde cada key tendr√° un value de un tipo predeterminado.</li>
<li><strong>pyplot</strong> se emplea para las gr√°ficas.</li>
<li><strong>itertools</strong> es una librer√≠a para construcci√≥n de iteradores.</li>
<li>la sentencia <strong>%matplotlib inline</strong> es por si se est√° haciendo este tutorial en un ipython notebook, las gr√°ficas de matplotlib sean mostradas dentro de celdas.</li>
</ul>
<h2>Definici√≥n de constantes</h2>
<pre><code class="language-python">length = <span class="hljs-number">10</span>
J = <span class="hljs-number">1.0</span>
kB = <span class="hljs-number">1.0</span>
</code></pre>
<ul>
<li><strong>length</strong> es la longitud de nuestro sistema.</li>
<li><strong>J</strong> es la constante de intercambio.</li>
<li><strong>kB</strong> es la constante de Boltzmann.</li>
</ul>
<h2>Creaci√≥n de arreglos</h2>
<pre><code class="language-python">sites = list()
spins = dict()
nbhs = defaultdict(list)
</code></pre>
<ul>
<li><strong>sites</strong> es el arreglo donde se almacenar√°n las parejas <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> de los elementos de la red.</li>
<li><strong>spins</strong> es un diccionario donde las keys son las parejas <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> y los values son el respectivo valor para el esp√≠n.</li>
<li><strong>nbhs</strong> es un <code>defaultdict(list)</code>, es decir, los <em>values</em> por defecto ser√°n listas vac√≠as. En este diccionario las <em>keys</em> son las parejas <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> y los <em>values</em> son una lista de tuplas, donde cada pareja corresponde a un vecino.</li>
</ul>
<h2>Creaci√≥n de la muestra</h2>
<pre><code class="language-python"><span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> itertools.product(range(length), range(length)):
    sites.append((x,y))
</code></pre>
<p>Debemos crear la red cuadrada de lado <strong>length</strong> y agregar a la lista <strong>sites</strong> las parejas <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> como tuplas. Se puede observar que <strong>sites</strong> es una lista donde cada elemento es una tupla que corresponde a un sitio:</p>
<pre><code class="language-python">print(sites)
</code></pre>
<pre><code>[(0, 0), (0, 1), (0, 2), (0, 3), (0, 4), (0, 5), (0, 6), (0, 7), (0, 8), (0, 9), (1, 0), (1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (1, 9), (2, 0), (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (2, 7), (2, 8), (2, 9), (3, 0), (3, 1), (3, 2), (3, 3), (3, 4), (3, 5), (3, 6), (3, 7), (3, 8), (3, 9), (4, 0), (4, 1), (4, 2), (4, 3), (4, 4), (4, 5), (4, 6), (4, 7), (4, 8), (4, 9), (5, 0), (5, 1), (5, 2), (5, 3), (5, 4), (5, 5), (5, 6), (5, 7), (5, 8), (5, 9), (6, 0), (6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6), (6, 7), (6, 8), (6, 9), (7, 0), (7, 1), (7, 2), (7, 3), (7, 4), (7, 5), (7, 6), (7, 7), (7, 8), (7, 9), (8, 0), (8, 1), (8, 2), (8, 3), (8, 4), (8, 5), (8, 6), (8, 7), (8, 8), (8, 9), (9, 0), (9, 1), (9, 2), (9, 3), (9, 4), (9, 5), (9, 6), (9, 7), (9, 8), (9, 9)]
</code></pre>
<h2>Creaci√≥n de estado aleatorio</h2>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">random_configuration</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-keyword">for</span> spin <span class="hljs-keyword">in</span> sites:
        spins[spin] = numpy.random.choice([<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>])
</code></pre>
<p>La funci√≥n <strong>random_configuration</strong> recorre todos los sitios y les asigna un valor de 1 o -1 aleatoriamente. Se emplear√° para darle el estado inicial al sistema a temperatura alta.</p>
<p>Si se ejecuta la funci√≥n <strong>random_configuration</strong>, el diccionario <strong>spins</strong> tomar√° valores de -1 o 1 para cada <em>key</em>:</p>
<pre><code class="language-python">random_configuration()
print(spins)
</code></pre>
<pre><code>{(7, 3): -1, (6, 9): -1, (1, 3): 1, (4, 8): -1, (3, 0): 1, (2, 8): 1, (9, 8): -1, (8, 0): -1, (0, 7): -1, (6, 2): -1, (1, 6): -1, (3, 7): 1, (2, 5): -1, (8, 5): 1, (5, 8): 1, (4, 0): 1, (9, 0): -1, (6, 7): 1, (5, 5): 1, (7, 6): -1, (5, 0): -1, (0, 4): 1, (3, 5): 1, (1, 1): 1, (3, 2): 1, (2, 6): 1, (8, 2): -1, (4, 5): 1, (9, 3): -1, (6, 0): -1, (1, 4): 1, (7, 5): -1, (2, 3): 1, (1, 9): -1, (8, 7): 1, (4, 2): 1, (9, 6): -1, (6, 5): 1, (5, 3): -1, (0, 1): -1, (7, 0): 1, (6, 8): -1, (3, 1): -1, (9, 9): -1, (0, 6): -1, (1, 7): -1, (0, 9): -1, (7, 8): 1, (2, 4): -1, (8, 4): 1, (5, 9): -1, (4, 7): 1, (9, 1): -1, (6, 6): 1, (5, 6): 1, (7, 7): 1, (2, 1): -1, (8, 9): -1, (9, 4): 1, (5, 1): -1, (0, 3): 1, (7, 2): -1, (1, 2): -1, (3, 8): -1, (4, 9): 1, (3, 3): -1, (2, 9): 1, (8, 1): 1, (4, 4): -1, (6, 3): 1, (1, 5): 1, (8, 8): -1, (3, 6): 1, (2, 2): -1, (8, 6): 1, (4, 1): 1, (9, 7): -1, (6, 4): 1, (5, 4): 1, (0, 0): -1, (7, 1): 1, (0, 5): -1, (1, 0): -1, (0, 8): -1, (7, 9): -1, (2, 7): 1, (8, 3): 1, (4, 6): -1, (9, 2): 1, (3, 4): -1, (6, 1): 1, (5, 7): 1, (7, 4): 1, (2, 0): -1, (1, 8): -1, (3, 9): 1, (4, 3): 1, (9, 5): -1, (5, 2): 1, (0, 2): 1}
</code></pre>
<h2>Funci√≥n para visualizaci√≥n de los espines</h2>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">plot_spins</span><span class="hljs-params">()</span>:</span>
    pyplot.figure()
    colors = {<span class="hljs-number">1</span>: <span class="hljs-string">"red"</span>, <span class="hljs-number">-1</span>: <span class="hljs-string">"blue"</span>}
    <span class="hljs-keyword">for</span> site, spin <span class="hljs-keyword">in</span> spins.items():
        x, y = site
        pyplot.quiver(x, y, <span class="hljs-number">0</span>, spin, pivot=<span class="hljs-string">"middle"</span>, color=colors[spin])
    pyplot.xticks(range(<span class="hljs-number">-1</span>,length+<span class="hljs-number">1</span>))
    pyplot.yticks(range(<span class="hljs-number">-1</span>,length+<span class="hljs-number">1</span>))
    pyplot.gca().set_aspect(<span class="hljs-string">"equal"</span>)
    pyplot.grid()
    pyplot.show
</code></pre>
<p>La funci√≥n consiste en recorrer cada pareja <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span> y en cada punto colocar una flecha de color rojo si el sitio tiene valor 1 o azul si tiene valor -1. Se ejecuta la funci√≥n <strong>plot_spins</strong> para visualizar el estado del sistema:</p>
<pre><code class="language-python">plot_spins()
</code></pre>
<p><img src="output_23_0.png" alt="png"></p>
<h2>Asignaci√≥n de vecinos</h2>
<pre><code class="language-python">nbhs = defaultdict(list)
<span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> spins:
    x, y = site
    <span class="hljs-keyword">if</span> x + <span class="hljs-number">1</span> &lt; length:
        nbhs[site].append(((x + <span class="hljs-number">1</span>) % length, y))
    <span class="hljs-keyword">if</span> x - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span>:
        nbhs[site].append(((x - <span class="hljs-number">1</span>) % length, y))
    <span class="hljs-keyword">if</span> y + <span class="hljs-number">1</span> &lt; length:
        nbhs[site].append((x, (y + <span class="hljs-number">1</span>) % length))
    <span class="hljs-keyword">if</span> y - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span>:
        nbhs[site].append((x, (y - <span class="hljs-number">1</span>) % length))
</code></pre>
<p>Recorremos todos los sitios y agregamos en su lista de <em>nbhs</em> los sitios vecinos. Recordemos que el sistema tiene condiciones peri√≥dicas de frontera.</p>
<h2>Creaci√≥n de funciones para c√°lculo de energ√≠a local, energ√≠a total y magnetizaci√≥n</h2>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">energy_site</span><span class="hljs-params">(site)</span>:</span>
    energy = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> nbh <span class="hljs-keyword">in</span> nbhs[site]:
        energy += spins[site] * spins[nbh]
    <span class="hljs-keyword">return</span> -J * energy

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">total_energy</span><span class="hljs-params">()</span>:</span>
    energy = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> site <span class="hljs-keyword">in</span> sites:
        energy += energy_site(site)
    <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * energy

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">magnetization</span><span class="hljs-params">()</span>:</span>
    mag = <span class="hljs-number">0.0</span>
    <span class="hljs-keyword">for</span> spin <span class="hljs-keyword">in</span> spins.values():
        mag += spin
    <span class="hljs-keyword">return</span> mag
</code></pre>
<ul>
<li>La funci√≥n <strong>energy_site</strong> calcula la energ√≠a local del sitio <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>. Debe recibir como argumento una tupla que corresponder√° al sitio <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(i, j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mclose">)</span></span></span></span>. Recordemos que el Hamiltoniano s√≥lo tiene el t√©rmino de intercambio.</li>
<li>La funci√≥n <strong>total_energy</strong> calcula la energ√≠a total del sistema sumando las energ√≠as locales de cada sitio. Al final se debe dividir por 2 debido a que las interacciones se cuentan 2 veces.</li>
<li>La funci√≥n <strong>magnetization</strong> computa la magnetizaci√≥n total de la red sumando los valores del esp√≠n de cada sitio.</li>
</ul>
<p>Si se imprime la magnetizaci√≥n del sistema, debe ser consecuente con la suma de los espines en la figura:</p>
<pre><code class="language-python">plot_spins()
print(<span class="hljs-string">"magnetization = "</span>, magnetization())
</code></pre>
<pre><code>magnetization =  0.0
</code></pre>
<p><img src="output_31_1.png" alt="png"></p>
<h2>Implementaci√≥n del algoritmo de Metr√≥polis</h2>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">metropolis</span><span class="hljs-params">(site, T)</span>:</span>
    oldSpin = spins[site]
    oldEnergy = energy_site(site)
    spins[site] *= <span class="hljs-number">-1</span>
    newEnergy = energy_site(site)
    deltaE = newEnergy - oldEnergy
    <span class="hljs-keyword">if</span> deltaE &lt;= <span class="hljs-number">0</span>:
        <span class="hljs-keyword">pass</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">if</span> numpy.random.uniform(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) &lt;= numpy.exp(-deltaE/(kB*T)):
            <span class="hljs-keyword">pass</span>
        <span class="hljs-keyword">else</span>:
            spins[site] *= <span class="hljs-number">-1</span>
</code></pre>
<p>Para mayor informaci√≥n, se puede consultar el algoritmo de Metr√≥polis en <a href="http://hua-zhou.github.io/teaching/st758-2014fall/top10/metropolis.pdf">http://hua-zhou.github.io/teaching/st758-2014fall/top10/metropolis.pdf</a></p>
<h2>Implementaci√≥n del paso Monte Carlo</h2>
<pre><code class="language-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">monte_carlo_step</span><span class="hljs-params">(T)</span>:</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(sites)):
        int_rand_site = numpy.random.randint(<span class="hljs-number">0</span>, len(sites))
        rand_site = sites[int_rand_site]
        metropolis(rand_site, T)
</code></pre>
<p>Un paso Monte Carlo consiste en recorrer la cantidad de sitios que tenga la red aleatoriamente y en cada elecci√≥n aplicar el algoritmo de Metr√≥polis.</p>
<h1>Simulaci√≥n</h1>
<h2>Definici√≥n de par√°metros</h2>
<pre><code class="language-python">amount_mcs = <span class="hljs-number">10000</span>
T_high = <span class="hljs-number">5.0</span>
T_low = <span class="hljs-number">0.01</span>
step = <span class="hljs-number">-0.1</span>
</code></pre>
<p>Se definen los par√°metros de la simulaci√≥n. Entre ellos est√° la cantidad de pasos Monte Carlo <strong>amount_mcs</strong>, la temperatura inicial <strong>T_high</strong> y la temperatura final <strong>T_low</strong>. Recordemos que <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi></mrow></msub><mo>‚â•</mo><msub><mi>T</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{high} \geq T_{low}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mrel">‚â•</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span></span></span></span>. A su vez, se define el paso entre temperaturas <strong>step</strong>.</p>
<h2>Ciclo de temperatura</h2>
<pre><code class="language-python">%%time
temps = numpy.arange(T_high, T_low, step)
energies = numpy.zeros(shape=(len(temps), amount_mcs))
magnetizations = numpy.zeros(shape=(len(temps), amount_mcs))
random_configuration()
<span class="hljs-keyword">for</span> ind_T, T <span class="hljs-keyword">in</span> enumerate(temps):
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(amount_mcs):
        monte_carlo_step(T)
        energies[ind_T, i] = total_energy()
        magnetizations[ind_T, i] = magnetization()
</code></pre>
<pre><code>CPU times: user 20min 45s, sys: 84 ms, total: 20min 45s
Wall time: 20min 45s
</code></pre>
<p>Se crea el arreglo de temperaturas con los valores establecidos anteriormente. Se aloja espacio para almacenar la energ√≠a del sistema y la magnetizaci√≥n. Se recorre las temperaturas y los pasos Monte Carlo. En cada paso de temperatura y en cada paso Monte Carlo se almacena la energ√≠a total y la magnetizaci√≥n del sistema. Los arreglos <strong>energies</strong> y <strong>magnetizations</strong> se emplear√°n para calcular los promedios estad√≠sticos.</p>
<p>Una simulaci√≥n con 10000 pasos Monte Carlo, desde <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi></mrow></msub><mo>=</mo><mn>5</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">T_{high}=5.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mrel">=</span><span class="mord mathrm">5</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span> hasta <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">T_{low}=0.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">‚Äã</span></span>‚Äã</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span></span></span></span> con una paso de <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Œî</mi><mi>T</mi><mo>=</mo><mo>‚àí</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\Delta T = -0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Œî</span><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mrel">=</span><span class="mord">‚àí</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">1</span></span></span></span> en un computador con Intel¬Æ Core‚Ñ¢ i7-3612QM CPU @ 2.10GHz tard√≥ 20min 45s.</p>
<p>Podr√≠as observar el estado final de la muestra a <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>1</mn></mrow><annotation encoding="application/x-tex">T=0.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span><span class="mord mathrm">1</span></span></span></span>:</p>
<pre><code class="language-python">plot_spins_spinst_spins()
</code></pre>
<p><img src="output_47_0.png" alt="png"></p>
<h1>Graficaci√≥n</h1>
<h2>C√°lculo de promedios</h2>
<pre><code class="language-python">tau = amount_mcs // <span class="hljs-number">2</span>
energy_mean = numpy.mean(energies[:, tau:], axis=<span class="hljs-number">1</span>)
magnetization_mean = abs(numpy.mean(magnetizations[:, tau:], axis=<span class="hljs-number">1</span>))
</code></pre>
<p>Se dejar√° la mitad de pasos Monte Carlo para relajaci√≥n. La otra mitad se ha de promediar.</p>
<h2>Gr√°ficas para la energ√≠a total y la magnetizaci√≥n en funci√≥n de la temperatura</h2>
<pre><code class="language-python">pyplot.figure()
pyplot.plot(temps, energy_mean, label=<span class="hljs-string">"Energy"</span>)
pyplot.legend()
pyplot.xlabel(<span class="hljs-string">r"$T$"</span>)
pyplot.ylabel(<span class="hljs-string">r"$\left&lt;E\right&gt;$"</span>)
pyplot.grid()
pyplot.show()

pyplot.figure()
pyplot.plot(temps, magnetization_mean, label=<span class="hljs-string">"Magnetization"</span>)
pyplot.legend()
pyplot.xlabel(<span class="hljs-string">r"$T$"</span>)
pyplot.ylabel(<span class="hljs-string">r"$\left&lt;M\right&gt;$"</span>)
pyplot.grid()
pyplot.show()
</code></pre>
<p><img src="output_53_0.png" alt="png"></p>
<p><img src="output_53_1.png" alt="png"></p>
<h2>C√°lculo de la susceptibilidad magn√©tica</h2>
<pre><code class="language-python">magnetization_std = numpy.std(numpy.abs(magnetizations[:, tau:]), axis=<span class="hljs-number">1</span>)
susceptibility = magnetization_std ** <span class="hljs-number">2</span> / (kB * temps)

pyplot.figure()
pyplot.plot(temps, susceptibility, label=<span class="hljs-string">"Susceptibility"</span>)
pyplot.legend()
pyplot.xlabel(<span class="hljs-string">r"$T$"</span>)
pyplot.ylabel(<span class="hljs-string">r"$\chi$"</span>)
pyplot.grid()
pyplot.show()
</code></pre>
<p><img src="output_55_0.png" alt="png"></p>
<h2>C√°lculo del calor espec√≠fico</h2>
<pre><code class="language-python">energy_std = numpy.std(energies[:, tau:], axis=<span class="hljs-number">1</span>)
specific_heat = energy_std ** <span class="hljs-number">2</span> / (kB * temps * temps)

pyplot.figure()
pyplot.plot(temps, specific_heat, label=<span class="hljs-string">"Specific heat"</span>)
pyplot.legend()
pyplot.xlabel(<span class="hljs-string">r"$T$"</span>)
pyplot.ylabel(<span class="hljs-string">r"$C_v$"</span>)
pyplot.grid()
pyplot.show()
</code></pre>
<p><img src="output_57_0.png" alt="png"></p>
<p>Te invitamos a continuar con tu aprendizaje desde este punto. Podr√≠as intentar obtener curvas de relajaci√≥n o graficar otro tipo de cantidades como cumulantes de Binder.</p>
<p>Cualquier inquietud, no dudes en escribirme <a href="/people/jdalzatec/">jdalzatec</a>.</p>
</div></div><span style="display:block;clear:both;" data-reactid="30"> </span></div><div class="bottomText" data-reactid="31"><div data-reactid="32"><!-- react-text: 33 -->PCM Computational Applications, designed by:<!-- /react-text --><a class="link" href="/people/jdalzatec/" data-reactid="34">jdalzatec</a><!-- react-text: 35 -->,<!-- /react-text --><a class="link" href="/people/dasabogals/" data-reactid="36">dasabogals</a><!-- react-text: 37 -->,<!-- /react-text --><a class="link" href="/people/odarbelaeze/" data-reactid="38">odarbelaeze</a></div></div></div></div><script src="/bundle.js?t=1529681161071"></script></body></html>